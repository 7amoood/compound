import{E as T,l as D,m as x,c as l,o as a,h as p,d as s,b as n,F as f,s as k,w as h,t as r,n as _,p as b,g as v,q as R,v as q,a as u,u as U}from"./vendor-C-E02GEk.js";import{T as P,M as j}from"./Modal-DUnvAo_q.js";import{P as I}from"./PullToRefresh-C4H_gFx7.js";import{_ as H}from"./app-Cmcii_rJ.js";/* empty css            */const L={name:"Help",components:{Head:D,Link:T,Modal:j,Toast:P,PullToRefresh:I},data(){return{activeTab:"available",tabs:[{id:"available",label:"Ø·Ù„Ø¨Ø§Øª Ù…ØªØ§Ø­Ø©"},{id:"my",label:"Ø·Ù„Ø¨Ø§ØªÙŠ"},{id:"helped",label:"Ø³Ø§Ø¹Ø¯Øª ÙÙŠÙ‡Ø§"}],requests:[],loading:!1,loadingMore:!1,nextPageUrl:null,showNewRequestModal:!1,showDetailsModal:!1,selectedRequest:null,loadingDetails:!1,pickingRequest:!1,newRequestDescription:"",submitting:!1,newComment:"",addingComment:!1,nextCommentsUrl:null,loadingMoreComments:!1,showNotificationsModal:!1,notifications:[],unreadNotificationsCount:0,loadingNotifications:!1,loadingMarkAll:!1,loadingMoreNotifications:!1,nextNotificationsUrl:null,showPickModal:!1,pickComment:"",confirmingPick:!1,cancellingRequestId:null}},computed:{currentUserId(){return U().props.auth?.user?.id},emptyIcon(){return{available:"volunteer_activism",my:"inbox",helped:"handshake",cancelled:"delete_sweep"}[this.activeTab]||"inbox"},emptyMessage(){return{available:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ù…Ø³Ø§Ø¹Ø¯Ø© Ø­Ø§Ù„ÙŠØ§Ù‹",my:"Ù„Ù… ØªØ·Ù„Ø¨ Ù…Ø³Ø§Ø¹Ø¯Ø© Ø¨Ø¹Ø¯",helped:"Ù„Ù… ØªØ³Ø§Ø¹Ø¯ Ø£Ø­Ø¯Ø§Ù‹ Ø¨Ø¹Ø¯",cancelled:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ù…Ù„ØºÙŠØ©"}[this.activeTab]||"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª"},canComment(){if(!this.selectedRequest)return!1;const i=this.selectedRequest.requester_id===this.currentUserId,e=this.selectedRequest.helper_id===this.currentUserId;return i||e}},watch:{activeTab(){this.loadData()},"$page.url":{handler(){const i=new URLSearchParams(window.location.search);i.has("request_id")&&this.openDetails({id:i.get("request_id")})}}},mounted(){this.loadData(),this.loadUnreadCount(),window.addEventListener("fcm-message",this.handleFcmMessage),window.addEventListener("open-help-details",this.handleOpenHelpDetails);const i=new URLSearchParams(window.location.search);i.has("request_id")&&this.openDetails({id:i.get("request_id")})},beforeUnmount(){window.removeEventListener("fcm-message",this.handleFcmMessage),window.removeEventListener("open-help-details",this.handleOpenHelpDetails)},methods:{handleOpenHelpDetails(i){i.detail?.requestId&&this.openDetails({id:i.detail.requestId})},async loadUnreadCount(){try{const i=await u.get("/api/notifications/unread-count");this.unreadNotificationsCount=i.data.count}catch(i){console.error(i)}},async loadNotifications(i="/api/notifications"){this.loadingNotifications=!0;try{const e=await u.get(i);e.data.success&&(i==="/api/notifications"?this.notifications=e.data.notifications.data:this.notifications=[...this.notifications,...e.data.notifications.data],this.nextNotificationsUrl=e.data.notifications.next_page_url)}catch(e){console.error(e)}finally{this.loadingNotifications=!1,this.loadingMoreNotifications=!1}},async loadMoreNotifications(){this.nextNotificationsUrl&&(this.loadingMoreNotifications=!0,this.loadNotifications(this.nextNotificationsUrl))},async markAllNotificationsAsRead(){this.loadingMarkAll=!0;try{await u.post("/api/notifications/read-all"),this.notifications.forEach(i=>i.is_read=!0),this.unreadNotificationsCount=0}catch{window.showToast("Ø­Ø¯Ø« Ø®Ø·Ø£","error")}finally{this.loadingMarkAll=!1}},async handleNotificationClick(i){if(!i.is_read)try{await u.post(`/api/notifications/${i.id}/read`),i.is_read=!0,this.unreadNotificationsCount=Math.max(0,this.unreadNotificationsCount-1)}catch(m){console.error(m)}let e=i.data||{};if(typeof e=="string")try{e=JSON.parse(e)}catch{}const c=e.help_request_id;c?(this.showNotificationsModal=!1,this.openDetails({id:c})):e.click_action&&(this.showNotificationsModal=!1,this.$nextTick(()=>{this.$inertia.visit(e.click_action)}))},handleFcmMessage(i){const e=i.detail;if(e?.data?.sender_id&&this.currentUserId&&e.data.sender_id==this.currentUserId)return;this.unreadNotificationsCount++,this.showNotificationsModal&&this.loadNotifications();const c=e.data?.help_request_id||e.data?.request_id,m=e.data?.type;(m==="help_comment"||m==="help_picked")&&this.showDetailsModal&&this.selectedRequest&&this.selectedRequest.id==c&&this.refreshCurrentDetails(),m==="help_picked"||m==="new_help_request"||m==="help_comment"&&!this.showDetailsModal?this.loadData(!0):this.activeTab==="available"&&this.loadData(!0)},async refreshCurrentDetails(){if(this.selectedRequest)try{const i=await u.get(`/api/help/${this.selectedRequest.id}`);if(i.data.success&&this.selectedRequest&&this.selectedRequest.id==i.data.request.id){const e=this.selectedRequest.comments?.length||0;this.selectedRequest=i.data.request,i.data.comments&&(this.selectedRequest.comments=i.data.comments.data.slice().reverse(),this.nextCommentsUrl=i.data.comments.next_page_url,this.selectedRequest.comments.length>e&&this.$nextTick(()=>{this.scrollToBottom()}))}}catch(i){console.error("Failed to refresh details:",i)}},async loadData(i=!1){i||(this.loading=!0,this.requests=[]),this.nextPageUrl=null;try{let e="/api/help/available";this.activeTab==="my"?e="/api/help/my-requests":this.activeTab==="helped"&&(e="/api/help/my-helps");const c=await u.get(e);c.data.success&&(this.requests=c.data.requests.data,this.nextPageUrl=c.data.requests.next_page_url)}catch(e){console.error(e)}finally{this.loading=!1}},async loadMore(){if(!(!this.nextPageUrl||this.loadingMore)){this.loadingMore=!0;try{const i=await u.get(this.nextPageUrl);i.data.success&&(this.requests.push(...i.data.requests.data),this.nextPageUrl=i.data.requests.next_page_url)}catch(i){console.error(i)}finally{this.loadingMore=!1}}},async submitNewRequest(){if(this.newRequestDescription.trim()){this.submitting=!0;try{(await u.post("/api/help",{description:this.newRequestDescription})).data.success&&(window.showToast("ØªÙ… Ù†Ø´Ø± Ø·Ù„Ø¨ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©","success"),this.showNewRequestModal=!1,this.newRequestDescription="",this.activeTab="my")}catch{window.showToast("Ø­Ø¯Ø« Ø®Ø·Ø£","error")}finally{this.submitting=!1}}},async startPick(i=null){i&&i.id&&(this.selectedRequest=i),this.pickingRequest=!0,setTimeout(()=>{this.showPickModal=!0,this.pickingRequest=!1},300)},async confirmPick(){if(!(!this.pickComment.trim()||this.confirmingPick)){this.confirmingPick=!0;try{const i=await u.post(`/api/help/${this.selectedRequest.id}/pick`,{comment:this.pickComment});i.data.success?(window.showToast("Ø´ÙƒØ±Ø§Ù‹ Ù„Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ! ðŸ™","success"),this.showPickModal=!1,this.pickComment="",this.showDetailsModal=!1,this.activeTab="helped"):window.showToast(i.data.message,"error")}catch(i){window.showToast(i.response?.data?.message||"Ø­Ø¯Ø« Ø®Ø·Ø£","error")}finally{this.confirmingPick=!1}}},async cancelRequest(i){if(!this.cancellingRequestId){this.cancellingRequestId=i.id;try{const e=await u.post(`/api/help/${i.id}/cancel`);e.data.success?(window.showToast("ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø·Ù„Ø¨","success"),this.loadData()):window.showToast(e.data.message,"error")}catch(e){window.showToast(e.response?.data?.message||"Ø­Ø¯Ø« Ø®Ø·Ø£","error")}finally{this.cancellingRequestId=null}}},async openDetails(i){this.selectedRequest=i,this.selectedRequest.comments=this.selectedRequest.comments?.reverse(),this.showDetailsModal=!0,this.loadingDetails=!0,this.nextCommentsUrl=null;try{const e=await u.get(`/api/help/${i.id}`);e.data.success&&this.selectedRequest&&this.selectedRequest.id===i.id&&(this.selectedRequest=e.data.request,e.data.comments&&(this.selectedRequest.comments=e.data.comments.data.slice().reverse(),this.nextCommentsUrl=e.data.comments.next_page_url,this.scrollToBottom()))}catch{this.selectedRequest&&this.selectedRequest.id===i.id&&window.showToast("ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø£Ø­Ø¯Ø« Ø§Ù„ØªÙØ§ØµÙŠÙ„","error")}finally{this.selectedRequest&&this.selectedRequest.id===i.id&&(this.loadingDetails=!1)}},async loadMoreComments(){if(!this.nextCommentsUrl||this.loadingMoreComments)return;this.loadingMoreComments=!0;const i=this.$refs.commentsContainer,e=i?i.scrollHeight:0;try{const c=await u.get(this.nextCommentsUrl);if(c.data.success){const m=c.data.comments.data.slice().reverse();this.selectedRequest.comments=[...m,...this.selectedRequest.comments],this.nextCommentsUrl=c.data.comments.next_page_url,this.$nextTick(()=>{i&&(i.scrollTop=i.scrollHeight-e)})}}catch(c){console.error(c)}finally{this.loadingMoreComments=!1}},scrollToBottom(){setTimeout(()=>{const i=this.$refs.commentsContainer;i&&i.scrollTo({top:i.scrollHeight,behavior:"smooth"})},50)},getCommentAuthorName(i){if(i.user_id===this.currentUserId)return"Ø£Ù†Øª";if(this.selectedRequest){if(i.user_id===this.selectedRequest.requester_id)return"Ø·Ø§Ù„Ø¨ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©";if(i.user_id===this.selectedRequest.helper_id)return"Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯"}return"Ù…Ø³ØªØ®Ø¯Ù…"},async addComment(){if(!(!this.newComment.trim()||this.addingComment)){this.addingComment=!0;try{const i=await u.post(`/api/help/${this.selectedRequest.id}/comment`,{comment:this.newComment});i.data.success&&(this.selectedRequest.comments||(this.selectedRequest.comments=[]),this.selectedRequest.comments.push(i.data.comment),this.newComment="",this.scrollToBottom())}catch(i){window.showToast(i.response?.data?.message||"Ø­Ø¯Ø« Ø®Ø·Ø£","error")}finally{this.addingComment=!1}}},formatTime(i){return i?new Date(i).toLocaleTimeString("ar-EG",{hour:"2-digit",minute:"2-digit"}):""},formatDate(i){if(!i)return"";const e=new Date(i),c=new Date;return Math.floor((c-e)/1e3)<60?"Ø§Ù„Ø¢Ù†":e.toDateString()===c.toDateString()?this.formatTime(i):e.toLocaleDateString("ar-EG",{day:"numeric",month:"short"})+" "+this.formatTime(i)}}},z={class:"relative flex h-[100vh] w-full flex-col overflow-hidden max-w-md mx-auto bg-background-light dark:bg-background-dark font-display",dir:"rtl"},A={class:"sticky top-0 z-20 bg-background-light/95 dark:bg-background-dark/95 backdrop-blur-md border-b border-slate-100 dark:border-slate-800/10 transition-all duration-200",style:{"padding-top":"env(safe-area-inset-top)"}},E={class:"flex items-center justify-between px-4 py-3"},B={key:0,class:"absolute top-1 right-1 size-2.5 bg-red-500 rounded-full border-2 border-white dark:border-background-dark"},F={class:"px-4 pt-4 pb-2"},V={class:"overflow-x-auto no-scrollbar -mx-4 px-4 pb-2 pt-2"},O={class:"flex gap-2 min-w-max pr-4 px-4"},S=["onClick"],G={class:"flex-1 overflow-y-auto overflow-x-hidden no-scrollbar pb-24"},J={class:"flex flex-col gap-3 p-4 min-h-[60vh]"},K={key:0,class:"text-center py-12 text-slate-400"},Q={key:1,class:"flex-1 flex flex-col items-center justify-center text-center py-12 text-slate-400"},W={class:"material-symbols-outlined text-5xl"},X={class:"mt-2"},Y=["onClick"],Z={class:"flex items-start justify-between gap-3 mb-3"},$={class:"flex items-center gap-3"},ee={class:"font-bold text-slate-900 dark:text-white text-sm"},te={key:0,class:"text-xs text-slate-500"},se={key:0},ie={key:1},oe={key:2},le={class:"text-xs text-slate-400"},ae={class:"text-sm text-slate-700 dark:text-slate-300 leading-relaxed line-clamp-3"},ne={key:0,class:"mt-3 flex items-center gap-2 bg-blue-50 dark:bg-blue-900/20 p-2 rounded-lg"},re={class:"flex-1"},de={class:"text-xs font-medium text-blue-700 dark:text-blue-300"},ce={key:0,class:"text-[10px] text-blue-600/70 dark:text-blue-400/70"},ue={key:0},me={key:1},pe={key:2},he={key:1,class:"mt-3"},fe=["onClick","disabled"],xe={key:0,class:"material-symbols-outlined animate-spin text-[18px]"},be={key:2,class:"mt-3"},ge=["onClick","disabled"],ye={key:0,class:"material-symbols-outlined animate-spin text-[18px]"},ke=["disabled"],_e={key:0,class:"material-symbols-outlined animate-spin text-[18px]"},we={class:"fixed bottom-0 left-0 right-0 bg-white/95 dark:bg-surface-dark/95 backdrop-blur-md border-t border-slate-200 dark:border-slate-800 pb-safe z-40"},ve={class:"flex items-center justify-around h-16 max-w-md mx-auto"},Re={class:"space-y-4"},qe=["disabled"],Ce={key:0,class:"material-symbols-outlined animate-spin text-[18px]"},Me={key:0,class:"space-y-4"},Ne={class:"flex items-center gap-3 pb-4 border-b border-slate-100 dark:border-slate-800"},Te={class:"font-bold text-slate-900 dark:text-white"},De={key:0,class:"text-xs text-slate-500"},Ue={key:0},Pe={key:1},je={key:2},Ie={class:"bg-slate-50 dark:bg-slate-800/50 p-4 rounded-xl"},He={class:"text-sm text-slate-700 dark:text-slate-300 leading-relaxed"},Le={key:0,class:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-xl"},ze={class:"flex items-center gap-3"},Ae={class:"font-bold text-slate-900 dark:text-white text-sm"},Ee={key:0,class:"text-[11px] text-blue-600/70 dark:text-blue-400/70"},Be={key:0},Fe={key:1},Ve={key:2},Oe={key:1,class:"space-y-3"},Se={key:0,class:"text-center py-4 text-slate-400"},Ge={key:0,class:"flex justify-center mb-2"},Je=["disabled"],Ke={key:0,class:"material-symbols-outlined animate-spin text-[12px]"},Qe={class:"flex justify-between items-start gap-4 mb-1"},We={class:"text-[9px] opacity-60 font-medium"},Xe={class:"text-sm leading-relaxed"},Ye={key:0,class:"flex gap-2"},Ze=["disabled"],$e={key:0,class:"material-symbols-outlined animate-spin text-[16px]"},et={key:1},tt={key:2,class:"pt-2"},st=["disabled"],it={key:0,class:"material-symbols-outlined animate-spin"},ot={key:1},lt={key:0,class:"flex items-center justify-between mb-4 px-1"},at=["disabled"],nt={key:0,class:"material-symbols-outlined animate-spin text-[14px]"},rt={class:"space-y-3"},dt={key:0,class:"text-center py-12 text-slate-400"},ct={key:1,class:"text-center py-8 text-slate-400"},ut=["onClick"],mt={class:"flex-1 min-w-0"},pt={class:"text-sm font-bold text-slate-900 dark:text-white"},ht={class:"text-xs text-slate-500 dark:text-slate-400 mt-0.5"},ft={class:"text-[10px] text-slate-400 mt-1"},xt={key:0,class:"size-2 bg-primary rounded-full flex-shrink-0 mt-2"},bt=["disabled"],gt={key:0,class:"material-symbols-outlined animate-spin text-[18px]"},yt={class:"space-y-4"},kt={key:0,class:"p-4 bg-slate-50 dark:bg-slate-800/50 rounded-2xl border border-slate-100 dark:border-slate-800"},_t={class:"text-sm text-slate-700 dark:text-slate-300 leading-relaxed italic"},wt={class:"space-y-2"},vt={class:"flex gap-3 pt-2"},Rt=["disabled"],qt={key:0,class:"material-symbols-outlined animate-spin text-[20px]"},Ct={key:1};function Mt(i,e,c,m,t,d){const C=x("Head"),M=x("Toast"),N=x("PullToRefresh"),w=x("Link"),g=x("Modal");return a(),l(f,null,[p(C,{title:"Ù…Ø³Ø§Ø¹Ø¯Ø©"}),p(M),s("div",z,[s("header",A,[s("div",E,[e[20]||(e[20]=s("div",{class:"flex items-center gap-3"},[s("div",{class:"size-10 rounded-full bg-rose-100 dark:bg-rose-900/30 flex items-center justify-center text-rose-600 dark:text-rose-400"},[s("span",{class:"material-symbols-outlined"},"volunteer_activism")]),s("div",null,[s("span",{class:"text-lg font-bold text-slate-900 dark:text-white"},"Ù…Ø³Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¬ÙŠØ±Ø§Ù†")])],-1)),s("button",{onClick:e[0]||(e[0]=o=>{t.showNotificationsModal=!0,d.loadNotifications()}),class:"relative p-2 rounded-xl hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors"},[e[19]||(e[19]=s("span",{class:"material-symbols-outlined text-slate-600 dark:text-slate-300"},"notifications",-1)),t.unreadNotificationsCount>0?(a(),l("span",B)):n("",!0)])])]),s("div",F,[s("button",{onClick:e[1]||(e[1]=o=>t.showNewRequestModal=!0),class:"w-full flex items-center justify-center gap-2 bg-primary hover:bg-blue-600 text-white font-bold h-12 rounded-xl shadow-lg shadow-primary/20 active:scale-[0.98] transition-all duration-200"},[...e[21]||(e[21]=[s("span",{class:"material-symbols-outlined"},"add_circle",-1),s("span",null,"Ø·Ù„Ø¨ Ù…Ø³Ø§Ø¹Ø¯Ø© Ø¬Ø¯ÙŠØ¯",-1)])])]),s("div",V,[s("div",O,[(a(!0),l(f,null,k(t.tabs,o=>(a(),l("button",{key:o.id,onClick:y=>t.activeTab=o.id,class:b(["h-8 px-4 rounded-full text-sm font-semibold shadow-sm transition-colors border",t.activeTab===o.id?"bg-slate-900 dark:bg-white text-white dark:text-slate-900 border-slate-900 dark:border-white":"bg-white dark:bg-surface-dark border-slate-200 dark:border-slate-700 text-slate-600 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-800"])},r(o.label),11,S))),128))])]),s("div",G,[p(N,{onRefresh:()=>d.loadData(!0),class:"min-h-full"},{default:h(()=>[s("div",J,[t.loading?(a(),l("div",K,[...e[22]||(e[22]=[s("span",{class:"material-symbols-outlined text-4xl animate-spin"},"progress_activity",-1)])])):t.requests.length===0?(a(),l("div",Q,[s("span",W,r(d.emptyIcon),1),s("p",X,r(d.emptyMessage),1)])):(a(!0),l(f,{key:2},k(t.requests,o=>(a(),l("div",{key:o.id,onClick:y=>d.openDetails(o),class:"bg-white dark:bg-surface-dark p-4 rounded-2xl shadow-sm border border-slate-100 dark:border-slate-700 cursor-pointer active:bg-slate-50 dark:active:bg-slate-800 transition-colors"},[s("div",Z,[s("div",$,[s("div",{class:"size-10 rounded-full bg-cover bg-center bg-slate-100",style:_(`background-image: url('${o.requester?.photo||"https://ui-avatars.com/api/?name="+(o.requester?.name||"U")}');`)},null,4),s("div",null,[s("p",ee,r(o.requester?.name),1),o.requester?(a(),l("p",te,[o.requester.block_no?(a(),l("span",se,"Ø¹Ù…Ø§Ø±Ø© "+r(o.requester.block_no),1)):n("",!0),o.requester.floor?(a(),l("span",ie," - Ø§Ù„Ø¯ÙˆØ± "+r(o.requester.floor),1)):n("",!0),o.requester.apt_no?(a(),l("span",oe," - Ø´Ù‚Ø© "+r(o.requester.apt_no),1)):n("",!0)])):n("",!0),s("p",le,r(d.formatDate(o.created_at)),1)])]),s("span",{class:b(["px-2 py-1 rounded-full text-[10px] font-bold",{"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":o.status==="open","bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400":o.status==="picked","bg-slate-100 text-slate-500 dark:bg-slate-800 dark:text-slate-400":o.status==="cancelled"}])},r(o.status==="open"?"Ù…ÙØªÙˆØ­":o.status==="picked"?"ØªÙ… Ø§Ù„Ø§Ù„ØªÙ‚Ø§Ø·":"Ù…Ù„ØºÙŠ"),3)]),s("p",ae,r(o.description),1),o.helper&&(t.activeTab==="my"||t.activeTab==="helped")?(a(),l("div",ne,[s("div",{class:"size-6 rounded-full bg-cover bg-center",style:_(`background-image: url('${o.helper?.photo||"https://ui-avatars.com/api/?name="+(o.helper?.name||"H")}');`)},null,4),s("div",re,[s("span",de,r(t.activeTab==="my"?"ÙŠØ³Ø§Ø¹Ø¯Ùƒ: ":"ØªØ³Ø§Ø¹Ø¯: ")+r(t.activeTab==="my"?o.helper?.name:o.requester?.name),1),t.activeTab==="my"&&o.helper?(a(),l("p",ce,[o.helper.block_no?(a(),l("span",ue,"Ø¹Ù…Ø§Ø±Ø© "+r(o.helper.block_no),1)):n("",!0),o.helper.floor?(a(),l("span",me," - Ø§Ù„Ø¯ÙˆØ± "+r(o.helper.floor),1)):n("",!0),o.helper.apt_no?(a(),l("span",pe," - Ø´Ù‚Ø© "+r(o.helper.apt_no),1)):n("",!0)])):n("",!0)])])):n("",!0),t.activeTab==="available"?(a(),l("div",he,[s("button",{onClick:v(y=>d.startPick(o),["stop"]),disabled:t.pickingRequest&&t.selectedRequest?.id===o.id,class:"w-full py-2 bg-primary text-white rounded-lg text-sm font-bold shadow-sm flex items-center justify-center gap-2"},[t.pickingRequest&&t.selectedRequest?.id===o.id?(a(),l("span",xe,"progress_activity")):n("",!0),e[23]||(e[23]=s("span",null,"Ø³Ø£Ø³Ø§Ø¹Ø¯ ðŸ™‹",-1))],8,fe)])):n("",!0),t.activeTab==="my"&&o.status==="open"?(a(),l("div",be,[s("button",{onClick:v(y=>d.cancelRequest(o),["stop"]),disabled:t.cancellingRequestId===o.id,class:"w-full py-2 bg-red-500 text-white rounded-lg text-sm font-bold flex items-center justify-center gap-2"},[t.cancellingRequestId===o.id?(a(),l("span",ye,"progress_activity")):n("",!0),e[24]||(e[24]=s("span",null,"Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø·Ù„Ø¨",-1))],8,ge)])):n("",!0)],8,Y))),128)),t.nextPageUrl&&!t.loading?(a(),l("button",{key:3,onClick:e[2]||(e[2]=(...o)=>d.loadMore&&d.loadMore(...o)),disabled:t.loadingMore,class:"w-full py-3 text-sm font-bold text-primary bg-primary/10 rounded-xl flex items-center justify-center gap-2"},[t.loadingMore?(a(),l("span",_e,"progress_activity")):n("",!0),s("span",null,r(t.loadingMore?"Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...":"ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø²ÙŠØ¯"),1)],8,ke)):n("",!0)])]),_:1},8,["onRefresh"])]),s("nav",we,[s("div",ve,[p(w,{href:"/dashboard",class:"flex flex-col items-center justify-center flex-1 h-full gap-1 text-slate-400 dark:text-slate-500 hover:text-slate-600 dark:hover:text-slate-300 transition-colors"},{default:h(()=>[...e[25]||(e[25]=[s("span",{class:"material-symbols-outlined"},"home",-1),s("span",{class:"text-[10px] font-medium"},"Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©",-1)])]),_:1}),p(w,{href:"/help",class:"flex flex-col items-center justify-center flex-1 h-full gap-1 text-primary"},{default:h(()=>[...e[26]||(e[26]=[s("span",{class:"material-symbols-outlined fill-1"},"volunteer_activism",-1),s("span",{class:"text-[10px] font-bold"},"Ù…Ø³Ø§Ø¹Ø¯Ø©",-1)])]),_:1}),p(w,{href:"/settings",class:"flex flex-col items-center justify-center flex-1 h-full gap-1 text-slate-400 dark:text-slate-500 hover:text-slate-600 dark:hover:text-slate-300 transition-colors"},{default:h(()=>[...e[27]||(e[27]=[s("span",{class:"material-symbols-outlined"},"person",-1),s("span",{class:"text-[10px] font-medium"},"Ø§Ù„Ø­Ø³Ø§Ø¨",-1)])]),_:1})])]),p(g,{show:t.showNewRequestModal,title:"Ø·Ù„Ø¨ Ù…Ø³Ø§Ø¹Ø¯Ø©",onClose:e[5]||(e[5]=o=>t.showNewRequestModal=!1)},{default:h(()=>[s("div",Re,[s("div",null,[e[28]||(e[28]=s("label",{class:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2"},"ÙˆØµÙ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©",-1)),R(s("textarea",{"onUpdate:modelValue":e[3]||(e[3]=o=>t.newRequestDescription=o),class:"w-full rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800/50 p-4 text-base text-slate-900 dark:text-white placeholder-slate-400 focus:border-primary focus:outline-none focus:ring-1 focus:ring-primary resize-none transition-colors",placeholder:"Ù…Ø«Ø§Ù„: Ù…Ø­ØªØ§Ø¬ Ø­Ø¯ ÙŠØ³Ø§Ø¹Ø¯Ù†ÙŠ Ø£Ù†Ù‚Ù„ Ø£Ø«Ø§Ø« Ø«Ù‚ÙŠÙ„...",rows:"4"},null,512),[[q,t.newRequestDescription]])]),s("button",{onClick:e[4]||(e[4]=(...o)=>d.submitNewRequest&&d.submitNewRequest(...o)),disabled:t.submitting||!t.newRequestDescription.trim(),class:"w-full py-4 bg-primary text-white font-bold rounded-xl shadow-lg shadow-primary/25 flex items-center justify-center gap-2 disabled:opacity-50"},[t.submitting?(a(),l("span",Ce,"progress_activity")):n("",!0),e[29]||(e[29]=s("span",null,"Ù†Ø´Ø± Ø·Ù„Ø¨ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©",-1))],8,qe)])]),_:1},8,["show"]),p(g,{show:t.showDetailsModal,title:"ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨",onClose:e[11]||(e[11]=o=>t.showDetailsModal=!1)},{default:h(()=>[t.selectedRequest?(a(),l("div",Me,[s("div",Ne,[s("div",{class:"size-12 rounded-full bg-cover bg-center",style:_(`background-image: url('${t.selectedRequest.requester?.photo||"https://ui-avatars.com/api/?name="+(t.selectedRequest.requester?.name||"U")}');`)},null,4),s("div",null,[s("p",Te,r(t.selectedRequest.requester?.name),1),t.selectedRequest.requester?(a(),l("p",De,[t.selectedRequest.requester.block_no?(a(),l("span",Ue,"Ø¹Ù…Ø§Ø±Ø© "+r(t.selectedRequest.requester.block_no),1)):n("",!0),t.selectedRequest.requester.floor?(a(),l("span",Pe," - Ø§Ù„Ø¯ÙˆØ± "+r(t.selectedRequest.requester.floor),1)):n("",!0),t.selectedRequest.requester.apt_no?(a(),l("span",je," - Ø´Ù‚Ø© "+r(t.selectedRequest.requester.apt_no),1)):n("",!0)])):n("",!0)])]),s("div",Ie,[s("p",He,r(t.selectedRequest.description),1)]),t.selectedRequest.helper?(a(),l("div",Le,[e[30]||(e[30]=s("p",{class:"text-xs font-bold text-blue-600 dark:text-blue-400 mb-2"},"Ø§Ù„Ù…ØªØ·ÙˆØ¹ Ù„Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©",-1)),s("div",ze,[s("div",{class:"size-10 rounded-full bg-cover bg-center",style:_(`background-image: url('${t.selectedRequest.helper?.photo||"https://ui-avatars.com/api/?name="+(t.selectedRequest.helper?.name||"H")}');`)},null,4),s("div",null,[s("p",Ae,r(t.selectedRequest.helper?.name),1),t.selectedRequest.helper?(a(),l("p",Ee,[t.selectedRequest.helper.block_no?(a(),l("span",Be,"Ø¹Ù…Ø§Ø±Ø© "+r(t.selectedRequest.helper.block_no),1)):n("",!0),t.selectedRequest.helper.floor?(a(),l("span",Fe," - Ø§Ù„Ø¯ÙˆØ± "+r(t.selectedRequest.helper.floor),1)):n("",!0),t.selectedRequest.helper.apt_no?(a(),l("span",Ve," - Ø´Ù‚Ø© "+r(t.selectedRequest.helper.apt_no),1)):n("",!0)])):n("",!0)])])])):n("",!0),t.selectedRequest.status==="picked"&&d.canComment?(a(),l("div",Oe,[t.loadingDetails&&(!t.selectedRequest.comments||t.selectedRequest.comments.length===0)?(a(),l("div",Se,[...e[31]||(e[31]=[s("span",{class:"material-symbols-outlined animate-spin text-2xl"},"progress_activity",-1),s("p",{class:"text-xs mt-1"},"Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª...",-1)])])):(a(),l(f,{key:1},[s("div",{ref:"commentsContainer",class:"max-h-60 overflow-y-auto overscroll-contain space-y-3 px-1 py-2 flex flex-col",onTouchstart:e[7]||(e[7]=v(()=>{},["stop"]))},[t.nextCommentsUrl?(a(),l("div",Ge,[s("button",{onClick:e[6]||(e[6]=(...o)=>d.loadMoreComments&&d.loadMoreComments(...o)),disabled:t.loadingMoreComments,class:"text-[11px] font-bold text-slate-500 bg-slate-100 dark:bg-slate-800 hover:bg-slate-200 dark:hover:bg-slate-700 px-3 py-1 rounded-full transition-colors flex items-center gap-1"},[t.loadingMoreComments?(a(),l("span",Ke,"progress_activity")):n("",!0),e[32]||(e[32]=s("span",null,"Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª Ø§Ù„Ø£Ù‚Ø¯Ù…",-1))],8,Je)])):n("",!0),(a(!0),l(f,null,k(t.selectedRequest.comments,o=>(a(),l("div",{key:o.id,class:b(["p-3 rounded-2xl max-w-[85%]",o.user_id===d.currentUserId?"bg-primary text-white ml-auto rounded-br-none":"bg-slate-100 dark:bg-slate-700/50 text-slate-800 dark:text-slate-200 mr-auto rounded-bl-none"])},[s("div",Qe,[s("p",{class:b(["text-[10px] font-bold opacity-80",o.user_id===d.currentUserId?"text-blue-100":"text-slate-500 dark:text-slate-400"])},r(d.getCommentAuthorName(o)),3),s("p",We,r(d.formatTime(o.created_at)),1)]),s("p",Xe,r(o.comment),1)],2))),128))],544),(t.selectedRequest.comments?.length||0)<50?(a(),l("div",Ye,[R(s("input",{"onUpdate:modelValue":e[8]||(e[8]=o=>t.newComment=o),type:"text",class:"flex-1 rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800/50 px-4 py-2 text-sm focus:border-primary focus:outline-none focus:ring-1 focus:ring-primary",placeholder:"Ø§ÙƒØªØ¨ ØªØ¹Ù„ÙŠÙ‚Ø§Ù‹..."},null,512),[[q,t.newComment]]),s("button",{onClick:e[9]||(e[9]=(...o)=>d.addComment&&d.addComment(...o)),disabled:!t.newComment.trim()||t.addingComment,class:"px-4 py-2 bg-primary text-white rounded-xl text-sm font-bold disabled:opacity-50"},[t.addingComment?(a(),l("span",$e,"progress_activity")):(a(),l("span",et,"Ø¥Ø±Ø³Ø§Ù„"))],8,Ze)])):n("",!0)],64))])):n("",!0),t.selectedRequest.status==="open"&&t.selectedRequest.requester_id!==d.currentUserId?(a(),l("div",tt,[s("button",{onClick:e[10]||(e[10]=(...o)=>d.startPick&&d.startPick(...o)),disabled:t.pickingRequest,class:"w-full py-3 bg-primary text-white font-bold rounded-xl flex items-center justify-center gap-2 shadow-lg shadow-primary/20 hover:bg-blue-600 transition-colors"},[t.pickingRequest?(a(),l("span",it,"progress_activity")):(a(),l("span",ot,"Ø³Ø£Ø³Ø§Ø¹Ø¯ ðŸ™‹"))],8,st)])):n("",!0)])):n("",!0)]),_:1},8,["show"]),p(g,{show:t.showNotificationsModal,title:"Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª",onClose:e[14]||(e[14]=o=>t.showNotificationsModal=!1)},{default:h(()=>[t.notifications.length>0?(a(),l("div",lt,[e[34]||(e[34]=s("h3",{class:"text-xs font-bold text-slate-400 uppercase tracking-wider"},"Ø³Ø¬Ù„ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª",-1)),t.unreadNotificationsCount>0?(a(),l("button",{key:0,disabled:t.loadingMarkAll,onClick:e[12]||(e[12]=(...o)=>d.markAllNotificationsAsRead&&d.markAllNotificationsAsRead(...o)),class:"text-xs font-bold text-primary hover:underline flex items-center gap-1"},[t.loadingMarkAll?(a(),l("span",nt,"progress_activity")):n("",!0),e[33]||(e[33]=s("span",null,"ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ÙƒÙ„ ÙƒÙ…Ù‚Ø±ÙˆØ¡",-1))],8,at)):n("",!0)])):n("",!0),s("div",rt,[t.loadingNotifications?(a(),l("div",dt,[...e[35]||(e[35]=[s("span",{class:"material-symbols-outlined text-5xl animate-spin"},"progress_activity",-1),s("p",{class:"mt-3 text-sm font-medium"},"Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª...",-1)])])):t.notifications.length===0?(a(),l("div",ct,[...e[36]||(e[36]=[s("span",{class:"material-symbols-outlined text-4xl"},"notifications_off",-1),s("p",{class:"mt-2"},"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª",-1)])])):n("",!0),(a(!0),l(f,null,k(t.notifications,o=>(a(),l("div",{key:o.id,onClick:y=>d.handleNotificationClick(o),class:b(["flex gap-3 p-3 rounded-xl cursor-pointer hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors",o.is_read?"bg-slate-50 dark:bg-slate-800/50":"bg-primary/5 border border-primary/20"])},[e[37]||(e[37]=s("div",{class:"size-10 rounded-full flex items-center justify-center flex-shrink-0 shadow-sm bg-slate-100 text-slate-600"},[s("span",{class:"material-symbols-outlined"},"notifications")],-1)),s("div",mt,[s("h4",pt,r(o.title),1),s("p",ht,r(o.body),1),s("p",ft,r(d.formatDate(o.created_at)),1)]),o.is_read?n("",!0):(a(),l("span",xt))],10,ut))),128)),t.nextNotificationsUrl?(a(),l("button",{key:2,onClick:e[13]||(e[13]=(...o)=>d.loadMoreNotifications&&d.loadMoreNotifications(...o)),disabled:t.loadingMoreNotifications,class:"w-full mt-2 py-3 text-sm font-bold text-primary bg-primary/10 dark:bg-primary/20 hover:bg-primary/20 rounded-xl transition-colors flex items-center justify-center gap-2"},[t.loadingMoreNotifications?(a(),l("span",gt,"progress_activity")):n("",!0),s("span",null,r(t.loadingMoreNotifications?"Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...":"ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø²ÙŠØ¯"),1)],8,bt)):n("",!0)])]),_:1},8,["show"]),p(g,{show:t.showPickModal,title:"ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©",onClose:e[18]||(e[18]=o=>t.showPickModal=!1)},{default:h(()=>[s("div",yt,[t.selectedRequest?(a(),l("div",kt,[e[38]||(e[38]=s("p",{class:"text-xs font-bold text-slate-400 mb-1 uppercase tracking-wider"},"ØªÙØ§ØµÙŠÙ„ Ø·Ù„Ø¨ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©:",-1)),s("p",_t,'"'+r(t.selectedRequest.description)+'"',1)])):n("",!0),e[40]||(e[40]=s("div",{class:"p-4 bg-primary/5 rounded-2xl border border-primary/10"},[s("p",{class:"text-sm text-slate-600 dark:text-slate-400 leading-relaxed"}," Ø£Ø±Ø³Ù„ Ø±Ø³Ø§Ù„Ø© Ø³Ø±ÙŠØ¹Ø© Ù„Ø¬ÙŠØ±Ø§Ù†Ùƒ Ù„ØªØ®Ø¨Ø±Ù‡Ù… ÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ùƒ Ù…Ø³Ø§Ø¹Ø¯ØªÙ‡Ù…. Ø³ÙŠØ¨Ø¯Ø£ Ù‡Ø°Ø§ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© Ø¨ÙŠÙ†ÙƒÙ…Ø§. ")],-1)),s("div",wt,[e[39]||(e[39]=s("label",{class:"text-xs font-bold text-slate-400 uppercase tracking-wider px-1"},"Ø±Ø³Ø§Ù„ØªÙƒ Ø§Ù„Ø£ÙˆÙ„Ù‰",-1)),R(s("textarea",{"onUpdate:modelValue":e[15]||(e[15]=o=>t.pickComment=o),rows:"3",class:"w-full rounded-2xl border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800/50 px-4 py-3 text-sm focus:border-primary focus:outline-none focus:ring-1 focus:ring-primary placeholder:text-slate-400",placeholder:"Ù…Ø«Ù„Ø§Ù‹: Ø£Ù†Ø§ ÙÙŠ Ø·Ø±ÙŠÙ‚ÙŠ Ø§Ù„Ø¢Ù†ØŒ Ù‡Ù„ ØªØ­ØªØ§Ø¬ Ø´ÙŠØ¦Ø§Ù‹ Ø¢Ø®Ø±ØŸ"},null,512),[[q,t.pickComment]])]),s("div",vt,[s("button",{onClick:e[16]||(e[16]=o=>t.showPickModal=!1),class:"flex-1 py-3 text-sm font-bold text-slate-500 bg-slate-100 dark:bg-slate-800 rounded-xl hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors"}," Ø¥Ù„ØºØ§Ø¡ "),s("button",{onClick:e[17]||(e[17]=(...o)=>d.confirmPick&&d.confirmPick(...o)),disabled:!t.pickComment.trim()||t.confirmingPick,class:"flex-[2] py-3 text-sm font-bold text-white bg-primary rounded-xl shadow-lg shadow-primary/20 hover:bg-blue-600 transition-all flex items-center justify-center gap-2"},[t.confirmingPick?(a(),l("span",qt,"progress_activity")):(a(),l("span",Ct,"Ø¥Ø±Ø³Ø§Ù„ ÙˆÙ…Ø³Ø§Ø¹Ø¯Ø© ðŸ™‹"))],8,Rt)])])]),_:1},8,["show"])])],64)}const jt=H(L,[["render",Mt]]);export{jt as default};
