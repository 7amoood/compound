const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/firebase-et7VdQX2.js","assets/app-D9M0x0n5.js","assets/vendor-C-E02GEk.js","assets/app-ByWlSE2R.css","assets/app-NGTrc6dN.css"])))=>i.map(i=>d[i]);
import{_,a as T}from"./app-D9M0x0n5.js";import{E as S,l as A,m as p,c as i,o as n,h as g,d as e,w,t as l,A as N,n as P,q as c,v as m,p as d,e as x,b as u,F as b,s as j,r as F,a as f,u as C}from"./vendor-C-E02GEk.js";import{M as q,T as V}from"./Modal-I3Tt5wnx.js";/* empty css            */const L={name:"Settings",components:{Head:A,Link:S,Toast:V,Modal:q},data(){return{form:{name:"",phone:""},passwordForm:{current_password:"",new_password:"",new_password_confirmation:""},saving:!1,changingPassword:!1,theme:"auto",avatars:["/avatars/man_1.png","/avatars/woman_1.png","/avatars/man_2.png","/avatars/woman_2.png","/avatars/man_3.png","/avatars/woman_3.png","/avatars/boy.png","/avatars/girl.png"],selectingAvatar:!1,showAvatarGallery:!1,nextAvatar:null,loggingOut:!1,notificationStatus:"default",requestingNotification:!1}},computed:{user(){const r=C();return r.props.auth?r.props.auth.user:{}},csrfToken(){return document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")},notificationStatusText(){switch(this.notificationStatus){case"granted":return"الإشعارات مفعّلة";case"denied":return"الإشعارات محظورة من المتصفح";default:return"اضغط لتفعيل الإشعارات"}}},watch:{user:{handler(r){r&&(this.form.name=r.name||"",this.form.phone=r.phone||"")},immediate:!0,deep:!0}},mounted(){localStorage.theme==="dark"?this.theme="dark":localStorage.theme==="light"?this.theme="light":this.theme="auto","Notification"in window&&(this.notificationStatus=Notification.permission)},methods:{async requestNotificationPermission(){if(!("Notification"in window)){window.showToast("المتصفح لا يدعم الإشعارات","error");return}this.requestingNotification=!0;try{const{requestNotificationPermission:r}=await T(async()=>{const{requestNotificationPermission:t}=await import("./firebase-et7VdQX2.js");return{requestNotificationPermission:t}},__vite__mapDeps([0,1,2,3,4]));await r(),this.notificationStatus=Notification.permission,this.notificationStatus==="granted"?window.showToast("تم تفعيل الإشعارات بنجاح","success"):this.notificationStatus==="denied"&&window.showToast("تم رفض الإشعارات. يمكنك تفعيلها من إعدادات المتصفح","error")}catch(r){console.error(r),window.showToast("حدث خطأ","error")}finally{this.requestingNotification=!1}},async saveProfile(){this.saving=!0;try{(await f.put("/api/settings/profile",{name:this.form.name,phone:this.form.phone})).data.success&&window.showToast("تم حفظ البيانات بنجاح","success")}catch{window.showToast("حدث خطأ أثناء الحفظ","error")}finally{this.saving=!1}},async selectAvatar(r){this.selectingAvatar=!0,this.nextAvatar=r;try{(await f.post("api/settings/avatar",{avatar:r})).data.success&&(window.showToast("تم تحديث الصورة الشخصية","success"),this.$inertia.reload({only:["auth"]}),setTimeout(()=>{this.showAvatarGallery=!1},500))}catch{window.showToast("حدث خطأ أثناء تحديث الصورة","error")}finally{this.selectingAvatar=!1,this.nextAvatar=null}},async changePassword(){if(!this.passwordForm.current_password||!this.passwordForm.new_password||!this.passwordForm.new_password_confirmation){window.showToast("يرجى ملء جميع الحقول","error");return}if(this.passwordForm.new_password!==this.passwordForm.new_password_confirmation){window.showToast("كلمة المرور الجديدة غير متطابقة","error");return}this.changingPassword=!0;try{const r=await f.put("/api/settings/password",this.passwordForm);r.data.success?(window.showToast("تم تحديث كلمة المرور بنجاح","success"),this.passwordForm={current_password:"",new_password:"",new_password_confirmation:""}):window.showToast(r.data.message||"حدث خطأ","error")}catch(r){window.showToast(r.response?.data?.message||"حدث خطأ","error")}finally{this.changingPassword=!1}},setTheme(r){this.theme=r,r==="dark"?(localStorage.theme="dark",document.documentElement.classList.add("dark")):r==="light"?(localStorage.theme="light",document.documentElement.classList.remove("dark")):(localStorage.removeItem("theme"),window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"))},logout(){this.loggingOut=!0,F.post("/logout",{},{onSuccess:()=>{sessionStorage.removeItem("fcm_token")},onFinish:()=>{this.loggingOut=!1}})}}},E={class:"relative flex h-[100vh] w-full flex-col mx-auto max-w-md bg-background-light dark:bg-background-dark font-display",dir:"rtl"},O={class:"sticky top-0 z-50 flex items-center justify-between px-4 py-3 bg-background-light/95 dark:bg-background-dark/95 backdrop-blur-md border-b border-gray-200 dark:border-gray-800",style:{"padding-top":"max(0.75rem, env(safe-area-inset-top))"}},M=["disabled"],G={class:"flex-1 overflow-y-auto no-scrollbar pb-24 px-0"},I={class:"flex flex-col items-center justify-center pt-8 pb-6 px-4"},z={class:"mt-3 text-center"},B={class:"text-xl font-bold text-[#0d141b] dark:text-white"},D={class:"text-sm text-gray-500 dark:text-gray-400 font-medium"},H={class:"px-4 mb-6"},U={class:"bg-surface-light dark:bg-surface-dark rounded-xl overflow-hidden shadow-sm divide-y divide-gray-100 dark:divide-gray-800"},W={class:"flex items-center px-4 py-3 bg-surface-light dark:bg-surface-dark"},R={class:"flex items-center px-4 py-3 bg-surface-light dark:bg-surface-dark"},J={class:"px-4 mb-6"},K={class:"bg-surface-light dark:bg-surface-dark rounded-xl overflow-hidden shadow-sm divide-y divide-gray-100 dark:divide-gray-800"},Q={class:"flex items-center px-4 py-3"},X={class:"flex items-center px-4 py-3"},Y={class:"flex items-center px-4 py-3"},Z=["disabled"],$={class:"px-4 mb-6"},tt={class:"bg-surface-light dark:bg-surface-dark rounded-xl overflow-hidden shadow-sm divide-y divide-gray-100 dark:divide-gray-800"},et={class:"flex items-center justify-between px-4 py-3"},st={class:"flex items-center gap-3"},at={class:"text-xs text-gray-500"},rt=["disabled"],ot={key:0,class:"material-symbols-outlined animate-spin text-[16px]"},it={key:1},nt={class:"flex flex-col px-4 py-3 gap-3"},lt={class:"grid grid-cols-3 gap-2 bg-gray-100 dark:bg-gray-800 p-1 rounded-xl"},dt={class:"px-4 mb-8"},ct=["disabled"],mt={key:0,class:"material-symbols-outlined animate-spin text-[20px]"},pt={class:"grid grid-cols-3 gap-4 p-2"},gt=["onClick","disabled"],xt=["src"],ut={key:0,class:"absolute inset-0 bg-primary/20 flex items-center justify-center"},ft={key:1,class:"absolute inset-0 bg-black/20 flex items-center justify-center"};function wt(r,t,bt,yt,s,o){const y=p("Head"),h=p("Toast"),v=p("Link"),k=p("Modal");return n(),i(b,null,[g(y,{title:"الإعدادات - خدمات المجمع"}),g(h),e("div",E,[e("header",O,[g(v,{href:"/dashboard",class:"flex items-center text-primary text-base font-normal -mr-1"},{default:w(()=>[...t[14]||(t[14]=[e("span",{class:"material-symbols-outlined text-2xl"},"chevron_right",-1),e("span",null,"رجوع",-1)])]),_:1}),t[15]||(t[15]=e("h1",{class:"text-[17px] font-semibold text-center text-[#0d141b] dark:text-white absolute left-1/2 transform -translate-x-1/2"},"الإعدادات",-1)),e("button",{onClick:t[0]||(t[0]=(...a)=>o.saveProfile&&o.saveProfile(...a)),disabled:s.saving,class:"text-primary text-[17px] font-semibold"},l(s.saving?"...":"حفظ"),9,M)]),e("div",G,[e("div",I,[e("div",{class:"relative cursor-pointer group",onClick:t[1]||(t[1]=a=>s.showAvatarGallery=!0)},[e("div",{class:"w-24 h-24 rounded-full bg-gray-200 dark:bg-gray-700 bg-cover bg-center shadow-sm border-2 border-white dark:border-gray-800 transition-transform active:scale-95",style:P(`background-image: url('${o.user.photo||"https://ui-avatars.com/api/?name="+o.user.name}');`)},null,4),t[16]||(t[16]=e("div",{class:"absolute bottom-0 right-0 bg-primary text-white rounded-full p-1.5 shadow-md border-2 border-white dark:border-gray-800 flex items-center justify-center group-hover:scale-110 transition-transform"},[e("span",{class:"material-symbols-outlined text-[16px] leading-none"},"photo_camera")],-1))]),e("div",z,[e("h2",B,l(o.user.name),1),e("p",D,l(o.user.role==="resident"?"ساكن":o.user.role==="provider"?"مقدم خدمة":"مسؤول")+" • "+l(o.user.apt_no?`شقة ${o.user.apt_no}`:o.user.phone),1)])]),e("div",H,[t[19]||(t[19]=e("h3",{class:"pr-4 mb-2 text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide"},"المعلومات الشخصية",-1)),e("div",U,[e("div",W,[t[17]||(t[17]=e("label",{class:"w-20 text-[16px] text-gray-900 dark:text-white font-normal"},"الاسم",-1)),c(e("input",{"onUpdate:modelValue":t[2]||(t[2]=a=>s.form.name=a),class:"flex-1 bg-transparent border-none p-0 text-[16px] text-primary text-left focus:ring-0 placeholder:text-gray-400 font-normal",type:"text"},null,512),[[m,s.form.name]])]),e("div",R,[t[18]||(t[18]=e("label",{class:"w-20 text-[16px] text-gray-900 dark:text-white font-normal"},"الهاتف",-1)),c(e("input",{"onUpdate:modelValue":t[3]||(t[3]=a=>s.form.phone=a),class:"flex-1 bg-transparent border-none p-0 text-[16px] text-primary text-left focus:ring-0 placeholder:text-gray-400 font-normal",type:"tel"},null,512),[[m,s.form.phone]])])])]),e("div",J,[t[23]||(t[23]=e("h3",{class:"pr-4 mb-2 text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide"},"كلمة المرور",-1)),e("div",K,[e("div",Q,[t[20]||(t[20]=e("label",{class:"w-28 text-[16px] text-gray-900 dark:text-white font-normal"},"الحالية",-1)),c(e("input",{"onUpdate:modelValue":t[4]||(t[4]=a=>s.passwordForm.current_password=a),class:"flex-1 bg-transparent border-none p-0 text-[16px] text-gray-900 dark:text-white text-left focus:ring-0 placeholder:text-gray-400 font-normal",type:"password",placeholder:"••••••••"},null,512),[[m,s.passwordForm.current_password]])]),e("div",X,[t[21]||(t[21]=e("label",{class:"w-28 text-[16px] text-gray-900 dark:text-white font-normal"},"الجديدة",-1)),c(e("input",{"onUpdate:modelValue":t[5]||(t[5]=a=>s.passwordForm.new_password=a),class:"flex-1 bg-transparent border-none p-0 text-[16px] text-gray-900 dark:text-white text-left focus:ring-0 placeholder:text-gray-400 font-normal",type:"password",placeholder:"••••••••"},null,512),[[m,s.passwordForm.new_password]])]),e("div",Y,[t[22]||(t[22]=e("label",{class:"w-28 text-[16px] text-gray-900 dark:text-white font-normal"},"تأكيد الجديدة",-1)),c(e("input",{"onUpdate:modelValue":t[6]||(t[6]=a=>s.passwordForm.new_password_confirmation=a),class:"flex-1 bg-transparent border-none p-0 text-[16px] text-gray-900 dark:text-white text-left focus:ring-0 placeholder:text-gray-400 font-normal",type:"password",placeholder:"••••••••"},null,512),[[m,s.passwordForm.new_password_confirmation]])])]),e("button",{onClick:t[7]||(t[7]=(...a)=>o.changePassword&&o.changePassword(...a)),disabled:s.changingPassword,class:"mt-3 w-full bg-slate-100 dark:bg-slate-800 rounded-xl p-3 text-primary font-medium text-[16px] transition-colors"},l(s.changingPassword?"جاري التحديث...":"تحديث كلمة المرور"),9,Z)]),e("div",$,[t[29]||(t[29]=e("h3",{class:"pr-4 mb-2 text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide"},"الإشعارات",-1)),e("div",tt,[e("div",et,[e("div",st,[e("span",{class:d(["material-symbols-outlined text-xl",s.notificationStatus==="granted"?"text-green-500":"text-gray-400"])},"notifications",2),e("div",null,[t[24]||(t[24]=e("span",{class:"text-[16px] text-gray-900 dark:text-white font-normal"},"الإشعارات الفورية",-1)),e("p",at,l(o.notificationStatusText),1)])]),e("button",{onClick:t[8]||(t[8]=(...a)=>o.requestNotificationPermission&&o.requestNotificationPermission(...a)),disabled:s.notificationStatus==="granted"||s.requestingNotification,class:d(["px-3 py-1.5 rounded-lg text-sm font-medium transition-colors",s.notificationStatus==="granted"?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"bg-primary text-white"])},[s.requestingNotification?(n(),i("span",ot,"progress_activity")):(n(),i("span",it,l(s.notificationStatus==="granted"?"مفعّل ✓":"تفعيل"),1))],10,rt)]),e("div",nt,[t[28]||(t[28]=e("span",{class:"text-[16px] text-gray-900 dark:text-white font-normal"},"المظهر",-1)),e("div",lt,[e("button",{onClick:t[9]||(t[9]=a=>o.setTheme("light")),class:d(["flex items-center justify-center py-2 px-3 rounded-lg text-sm font-medium transition-all",s.theme==="light"?"bg-white dark:bg-gray-700 text-primary shadow-sm":"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200"])},[...t[25]||(t[25]=[e("span",{class:"material-symbols-outlined text-[18px] ml-1"},"light_mode",-1),x(" فاتح ",-1)])],2),e("button",{onClick:t[10]||(t[10]=a=>o.setTheme("dark")),class:d(["flex items-center justify-center py-2 px-3 rounded-lg text-sm font-medium transition-all",s.theme==="dark"?"bg-white dark:bg-gray-700 text-primary shadow-sm":"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200"])},[...t[26]||(t[26]=[e("span",{class:"material-symbols-outlined text-[18px] ml-1"},"dark_mode",-1),x(" داكن ",-1)])],2),e("button",{onClick:t[11]||(t[11]=a=>o.setTheme("auto")),class:d(["flex items-center justify-center py-2 px-3 rounded-lg text-sm font-medium transition-all",s.theme==="auto"?"bg-white dark:bg-gray-700 text-primary shadow-sm":"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200"])},[...t[27]||(t[27]=[e("span",{class:"material-symbols-outlined text-[18px] ml-1"},"settings_brightness",-1),x(" تلقائي ",-1)])],2)])])])]),t[34]||(t[34]=N('<div class="px-4 mb-8" data-v-140bce48><h3 class="pr-4 mb-2 text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide" data-v-140bce48>الدعم والقانون</h3><div class="bg-surface-light dark:bg-surface-dark rounded-xl overflow-hidden shadow-sm divide-y divide-gray-100 dark:divide-gray-800" data-v-140bce48><a class="flex items-center justify-between px-4 py-3 active:bg-gray-50 dark:active:bg-gray-800 transition-colors group" href="#" data-v-140bce48><div class="flex items-center gap-3" data-v-140bce48><div class="w-7 h-7 rounded-md bg-primary/10 flex items-center justify-center text-primary" data-v-140bce48><span class="material-symbols-outlined text-[18px]" data-v-140bce48>help</span></div><span class="text-[16px] text-gray-900 dark:text-white font-normal" data-v-140bce48>مركز المساعدة</span></div><span class="material-symbols-outlined text-gray-400 text-xl" data-v-140bce48>chevron_left</span></a><a class="flex items-center justify-between px-4 py-3 active:bg-gray-50 dark:active:bg-gray-800 transition-colors group" href="#" data-v-140bce48><div class="flex items-center gap-3" data-v-140bce48><div class="w-7 h-7 rounded-md bg-blue-500/10 flex items-center justify-center text-blue-500" data-v-140bce48><span class="material-symbols-outlined text-[18px]" data-v-140bce48>lock</span></div><span class="text-[16px] text-gray-900 dark:text-white font-normal" data-v-140bce48>سياسة الخصوصية</span></div><span class="material-symbols-outlined text-gray-400 text-xl" data-v-140bce48>chevron_left</span></a><a class="flex items-center justify-between px-4 py-3 active:bg-gray-50 dark:active:bg-gray-800 transition-colors group" href="#" data-v-140bce48><div class="flex items-center gap-3" data-v-140bce48><div class="w-7 h-7 rounded-md bg-purple-500/10 flex items-center justify-center text-purple-500" data-v-140bce48><span class="material-symbols-outlined text-[18px]" data-v-140bce48>description</span></div><span class="text-[16px] text-gray-900 dark:text-white font-normal" data-v-140bce48>شروط الخدمة</span></div><span class="material-symbols-outlined text-gray-400 text-xl" data-v-140bce48>chevron_left</span></a></div></div>',1)),e("div",dt,[e("button",{onClick:t[12]||(t[12]=(...a)=>o.logout&&o.logout(...a)),disabled:s.loggingOut,class:"w-full flex items-center justify-center gap-2 bg-surface-light dark:bg-surface-dark rounded-xl p-3 shadow-sm text-red-500 font-medium text-[16px] active:bg-red-50 dark:active:bg-red-900/20 transition-colors disabled:opacity-70"},[s.loggingOut?(n(),i("span",mt,"progress_activity")):u("",!0),e("span",null,l(s.loggingOut?"جاري الخروج...":"تسجيل الخروج"),1)],8,ct),t[30]||(t[30]=e("p",{class:"text-center text-xs text-gray-400 mt-4"},"CommunityApp v1.0.0",-1))]),g(k,{show:s.showAvatarGallery,title:"اختر صورة البروفيل",onClose:t[13]||(t[13]=a=>s.showAvatarGallery=!1)},{default:w(()=>[e("div",pt,[(n(!0),i(b,null,j(s.avatars,a=>(n(),i("button",{key:a,onClick:ht=>o.selectAvatar(a),disabled:s.selectingAvatar,class:d(["relative aspect-square rounded-2xl overflow-hidden border-2 transition-all active:scale-95",o.user.photo?.endsWith(a)?"border-primary ring-4 ring-primary/20":"border-slate-100 dark:border-slate-700"])},[e("img",{src:a,class:"w-full h-full object-cover"},null,8,xt),o.user.photo?.endsWith(a)?(n(),i("div",ut,[...t[31]||(t[31]=[e("span",{class:"material-symbols-outlined text-white text-2xl font-bold"},"check_circle",-1)])])):u("",!0),s.selectingAvatar&&s.nextAvatar===a?(n(),i("div",ft,[...t[32]||(t[32]=[e("span",{class:"material-symbols-outlined text-white animate-spin"},"progress_activity",-1)])])):u("",!0)],10,gt))),128))]),t[33]||(t[33]=e("p",{class:"text-center text-xs text-slate-400 mt-6 pb-2"},"اختر الصورة التي تعبر عنك وسيتم تحديثها فوراً",-1))]),_:1},8,["show"])])])],64)}const St=_(L,[["render",wt],["__scopeId","data-v-140bce48"]]);export{St as default};
