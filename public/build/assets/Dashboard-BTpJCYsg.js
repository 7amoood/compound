import{B as R,i as F,j as g,c as i,o as l,k as f,d as e,n as _,t as r,b as d,p as b,l as x,e as h,F as m,m as y,u as M,w as C,v as N,a as p,x as q}from"./vendor-CWDXIMv3.js";import{T as z,M as U}from"./Modal-B9RVIOIj.js";import{P as S,r as A}from"./firebase-Buwz2wky.js";import{_ as D}from"./app-BabTmADt.js";/* empty css            */const L={name:"ProviderDashboard",components:{Head:F,Link:R,Modal:U,Toast:z,PullToRefresh:S},data(){return{activeTab:new URLSearchParams(window.location.search).get("tab")||"available",availableJobs:[],myJobs:[],reviews:[],reviewsPage:1,hasMoreReviews:!1,loading:!0,stats:{},showProposalModal:!1,showNotificationsModal:!1,notifications:[],loadingNotifications:!1,nextNotificationsUrl:null,loadingMoreNotifications:!1,unreadNotificationsCount:0,selectedJob:null,proposalForm:{price:"",notes:""},submittingProposal:!1,editingProposal:null,showConfirmModal:!1,confirmMessage:"",confirmAction:null,processingConfirm:!1,myJobsFilter:new URLSearchParams(window.location.search).get("filter")||"active"}},computed:{user(){const s=q();return s.props.auth?s.props.auth.user:{}},filteredMyJobs(){return this.myJobsFilter==="active"?this.myJobs.filter(s=>s.status==="accepted_offer"||s.status==="in_progress"):this.myJobs.filter(s=>s.status===this.myJobsFilter)}},mounted(){this.loadStats(),this.loadUnreadCount(),this.switchToTab(this.activeTab),setTimeout(()=>A(),1e3);const s=new URLSearchParams(window.location.search);s.has("request_id")&&this.focusRequest(parseInt(s.get("request_id"))),window.addEventListener("fcm-message",this.handleFcmMessage),window.addEventListener("open-request-details",this.handleOpenRequestDetails)},beforeUnmount(){window.removeEventListener("fcm-message",this.handleFcmMessage),window.removeEventListener("open-request-details",this.handleOpenRequestDetails)},methods:{handleOpenRequestDetails(s){s.detail&&s.detail.requestId&&this.focusRequest(s.detail.requestId)},handleFcmMessage(s){this.unreadNotificationsCount++,this.showNotificationsModal&&this.loadNotifications(),s.detail?.data?.request_id&&(this.loadAvailableJobs(),this.loadMyJobs())},async triggerRefresh(){this.loading=!0;try{await Promise.all([this.loadStats(),this.loadUnreadCount(),this.loadAvailableJobs(!1),this.loadMyJobs(!1),this.activeTab==="reviews"?this.loadReviews(!1,!1):Promise.resolve()])}catch(s){console.error(s)}finally{this.loading=!1}},async focusRequest(s){this.myJobs.length===0&&await this.loadMyJobs();const t=this.myJobs.find(u=>u.id===s);if(t){this.switchToTab("myjobs"),this.myJobsFilter=t.status==="completed"?"completed":"active";return}this.availableJobs.length===0&&await this.loadAvailableJobs();const c=this.availableJobs.find(u=>u.id===s);if(c){this.switchToTab("available"),this.openProposalModal(c),this.$nextTick(()=>{const u=new URL(window.location);u.searchParams.set("tab","available"),u.searchParams.set("request_id",s),window.history.replaceState(window.history.state,"",u)});return}},setMyJobsFilter(s){this.myJobsFilter=s,this.updateUrlParams({filter:s})},switchToTab(s){this.activeTab=s;const t={tab:s};s!=="myjobs"?t.filter=null:t.filter=this.myJobsFilter,this.updateUrlParams(t),s==="available"?this.loadAvailableJobs():s==="myjobs"?this.loadMyJobs():s==="reviews"&&this.loadReviews(!0)},updateUrlParams(s){const t=new URL(window.location);Object.keys(s).forEach(c=>{s[c]===null?t.searchParams.delete(c):t.searchParams.set(c,s[c])}),window.history.replaceState(window.history.state,"",t)},async loadStats(){try{const s=await p.get("/api/provider/stats");s.data.success&&(this.stats=s.data.stats)}catch{}},async loadAvailableJobs(s=!0){s&&(this.loading=!0);try{const t=await p.get("/api/provider/available-requests");t.data.success&&(this.availableJobs=t.data.requests.data)}catch(t){console.error(t)}finally{s&&(this.loading=!1)}},async loadMyJobs(s=!0){s&&(this.loading=!0);try{const t=await p.get("/api/provider/my-jobs");t.data.success&&(this.myJobs=t.data.jobs.data)}catch(t){console.error(t)}finally{s&&(this.loading=!1)}},async loadReviews(s=!0,t=!0){s&&(this.reviewsPage=1,this.reviews=[]),t&&(this.loading=!0);try{const c=await p.get(`/api/provider/reviews?page=${this.reviewsPage}`);c.data.success&&(s?this.reviews=c.data.reviews.data:this.reviews=[...this.reviews,...c.data.reviews.data],this.hasMoreReviews=!!c.data.reviews.next_page_url)}catch(c){console.error(c)}finally{t&&(this.loading=!1)}},loadMoreReviews(){this.reviewsPage++,this.loadReviews(!1)},openProposalModal(s){this.selectedJob=s,s.proposals&&s.proposals.length>0?(this.editingProposal=s.proposals[0],this.proposalForm={price:this.editingProposal.price,notes:this.editingProposal.notes}):(this.editingProposal=null,this.proposalForm={price:"",notes:""}),this.showProposalModal=!0},async submitProposal(){this.submittingProposal=!0;try{let s;this.editingProposal?s=await p.put(`/api/proposals/${this.editingProposal.id}`,this.proposalForm):s=await p.post(`/api/requests/${this.selectedJob.id}/proposals`,this.proposalForm),s.data.success?(window.showToast(this.editingProposal?"تم تعديل العرض بنجاح":"تم تقديم العرض بنجاح","success"),this.showProposalModal=!1,this.loadAvailableJobs()):window.showToast(s.data.message,"error")}catch(s){window.showToast("حدث خطأ","error"),console.error(s)}finally{this.submittingProposal=!1}},updateJobStatus(s,t){this.confirmMessage=t==="in_progress"?"هل تود بدء العمل الآن؟ سيتم إشعار العميل بذلك.":"هل تود تأكيد إكمال العمل؟ سيتم إشعار العميل وإتاحة التقييم.",this.showConfirmModal=!0,this.confirmAction=async()=>{this.processingConfirm=!0;try{const c=this.myJobs.find(n=>n.id===s);let u="";t==="in_progress"?u=`/api/proposals/${c.accepted_proposal?.id}/start`:u=`/api/requests/${s}/complete`;const a=await p.post(u);a.data.success?(window.showToast("تم تحديث حالة العمل","success"),this.loadMyJobs(),t==="completed"&&this.loadStats(),this.showConfirmModal=!1):(window.showToast(a.data.message||"حدث خطأ","error"),this.showConfirmModal=!1)}catch(c){console.error(c),window.showToast("حدث خطأ","error"),this.showConfirmModal=!1}finally{this.processingConfirm=!1}}},handleNotificationClick(s){s.is_read||(p.post(`/api/notifications/${s.id}/read`).catch(()=>{}),s.is_read=!0,this.unreadNotificationsCount=Math.max(0,this.unreadNotificationsCount-1));const t=s.data?.request_id;if(t){if(window.history.state?.modal){const c={...window.history.state};delete c.modal,window.history.replaceState(c,"",window.location.href)}this.showNotificationsModal=!1,this.focusRequest(t)}else this.showNotificationsModal=!1},async loadNotifications(){this.loadingNotifications=!0;try{const s=await p.get("/api/notifications");s.data.success&&(this.notifications=s.data.notifications.data,this.nextNotificationsUrl=s.data.notifications.next_page_url||null,s.data.unread_count!==void 0&&(this.unreadNotificationsCount=s.data.unread_count))}catch(s){console.error(s)}finally{this.loadingNotifications=!1}},async loadMoreNotifications(){if(!(!this.nextNotificationsUrl||this.loadingMoreNotifications)){this.loadingMoreNotifications=!0;try{const s=await p.get(this.nextNotificationsUrl);s.data.success&&(this.notifications=[...this.notifications,...s.data.notifications.data],this.nextNotificationsUrl=s.data.notifications.next_page_url||null)}catch(s){console.error(s)}finally{this.loadingMoreNotifications=!1}}},async markAllNotificationsAsRead(){try{(await p.post("/api/notifications/read-all")).data.success&&(this.notifications.forEach(t=>t.is_read=!0),this.unreadNotificationsCount=0,window.showToast("تم تحديد الكل كمقروء","success"))}catch(s){console.error(s),window.showToast("حدث خطأ","error")}},async loadUnreadCount(){try{const s=await p.get("/api/notifications/unread-count");s.data.success&&(this.unreadNotificationsCount=s.data.count)}catch{}},formatDate(s){return new Date(s).toLocaleDateString("ar-EG",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}}},E={class:"relative flex h-[100dvh] w-full flex-col overflow-hidden max-w-md mx-auto bg-background-light dark:bg-background-dark shadow-2xl font-display",dir:"rtl"},V={class:"flex items-center px-4 py-3 pb-2 justify-between z-10 bg-background-light/95 dark:bg-background-dark/95 backdrop-blur-md sticky top-0 transition-all duration-300"},B={class:"flex items-center gap-3"},I={class:"relative"},O={class:"text-slate-500 dark:text-slate-400 text-xs font-medium"},H={class:"flex items-center justify-end"},G={key:0,class:"absolute top-2 right-2.5 size-2 bg-red-500 rounded-full"},K={class:"flex-1 overflow-y-auto no-scrollbar pb-24"},Q={class:"px-4 py-3 sticky top-0 z-10 bg-background-light/95 dark:bg-background-dark/95 backdrop-blur-sm"},W={class:"flex h-12 w-full items-center justify-center rounded-xl bg-slate-200 dark:bg-slate-800 p-1"},X={key:0,class:"absolute inset-0 z-0 rounded-lg bg-primary shadow-sm"},Y={key:0,class:"absolute inset-0 z-0 rounded-lg bg-primary shadow-sm"},Z={key:0,class:"absolute inset-0 z-0 rounded-lg bg-primary shadow-sm"},j={class:"px-4 mb-2 grid grid-cols-2 gap-3"},$={class:"bg-white dark:bg-slate-800 p-3 rounded-xl border border-slate-100 dark:border-slate-700 shadow-sm"},tt={class:"text-xl font-bold text-slate-900 dark:text-white"},et={class:"bg-white dark:bg-slate-800 p-3 rounded-xl border border-slate-100 dark:border-slate-700 shadow-sm"},st={class:"text-xl font-bold text-slate-900 dark:text-white"},ot={class:"px-4 pt-2 pb-2 flex justify-between items-end"},at={class:"text-base font-bold text-slate-900 dark:text-white"},it={class:"flex flex-col gap-4 px-4 pb-4"},lt={key:0,class:"text-center py-8 text-slate-400"},rt={key:0,class:"flex flex-col items-center justify-center p-8 text-center opacity-60"},nt={class:"p-4 flex flex-col gap-3"},dt={class:"flex justify-between items-start"},ct={class:"flex items-center gap-2 mb-1"},ut={class:"bg-white/90 dark:bg-slate-900/90 backdrop-blur px-2.5 py-1 rounded-full flex items-center gap-1 shadow-sm border border-slate-100 dark:border-slate-700"},pt={class:"material-symbols-outlined text-primary text-[16px]"},ft={class:"text-xs font-bold text-slate-800 dark:text-slate-200"},mt={class:"text-slate-900 dark:text-white text-lg font-bold leading-tight mb-1"},xt={class:"flex flex-col gap-0.5 text-slate-500 dark:text-slate-400"},bt={class:"flex items-center gap-1"},ht={class:"text-xs font-medium"},gt={key:0,class:"flex items-center gap-1 text-xs px-1"},yt=["href"],vt={class:"bg-slate-900/60 backdrop-blur px-2 py-1 rounded-md text-xs font-medium text-white flex items-center gap-1"},wt={key:0,class:"flex items-center justify-center gap-1 text-xs font-semibold text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/20 px-3 py-2 rounded-xl w-full"},kt={class:"bg-slate-50 dark:bg-slate-700/50 p-3 rounded-lg border border-slate-100 dark:border-slate-700/50"},_t={class:"text-slate-600 dark:text-slate-300 text-sm line-clamp-2"},Mt={class:"pt-1 flex gap-3"},Ct=["onClick"],Nt={key:0},Jt={key:1},Tt={class:"material-symbols-outlined text-[18px]"},Pt={class:"flex gap-2 mb-4 overflow-x-auto no-scrollbar pb-1"},Rt={key:0,class:"flex flex-col items-center justify-center p-8 text-center opacity-60"},Ft={class:"text-slate-500 dark:text-slate-400 text-sm"},qt={class:"flex justify-between items-start"},zt={class:"text-[10px] font-bold text-primary uppercase tracking-wider mb-1 block"},Ut={class:"font-bold text-slate-900 dark:text-white text-lg"},St=["href"],At={class:"mt-2 text-slate-500 dark:text-slate-400 text-xs"},Dt={class:"flex items-center gap-1"},Lt={key:0,class:"flex items-center gap-1 mt-1"},Et=["href"],Vt={key:0,class:"flex items-center justify-center gap-1 text-xs font-semibold text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/20 px-3 py-2 rounded-xl w-full"},Bt={class:"flex items-center justify-between pt-3 border-t border-slate-100 dark:border-slate-700"},It={class:"font-bold text-xl text-emerald-600"},Ot={key:0,class:"flex gap-2"},Ht=["onClick"],Gt=["onClick"],Kt={key:0,class:"flex flex-col items-center justify-center p-8 text-center opacity-60"},Qt={key:1,class:"space-y-4"},Wt={class:"flex justify-between items-start"},Xt={class:"flex items-center gap-3"},Yt={class:"font-bold text-slate-900 dark:text-white text-sm"},Zt={class:"text-xs text-slate-400"},jt={class:"flex items-center gap-1 bg-amber-50 dark:bg-amber-900/20 px-2 py-1 rounded-lg"},$t={class:"font-bold text-amber-600 dark:text-amber-400 text-sm"},te={key:0,class:"text-sm text-slate-600 dark:text-slate-300 leading-relaxed bg-slate-50 dark:bg-slate-900/50 p-3 rounded-lg relative"},ee={class:"relative"},se={class:"flex items-center gap-2 mt-1"},oe={class:"text-[10px] font-bold px-2 py-0.5 bg-slate-100 dark:bg-slate-700 rounded text-slate-500"},ae={class:"fixed bottom-0 left-0 right-0 bg-white/95 dark:bg-slate-900/95 backdrop-blur-md border-t border-slate-200 dark:border-slate-800 pb-safe z-40"},ie={class:"flex items-center justify-around h-16 max-w-md mx-auto"},le={class:"space-y-4"},re={class:"flex flex-col gap-1.5"},ne={class:"flex flex-col gap-1.5"},de=["disabled"],ce={key:0,class:"material-symbols-outlined animate-spin"},ue={key:0,class:"flex items-center justify-between mb-4 px-1"},pe={class:"space-y-3"},fe={key:0,class:"text-center py-12 text-slate-400"},me={key:1,class:"text-center py-8 text-slate-400"},xe=["onClick"],be={class:"flex-1"},he={class:"text-sm font-bold"},ge={class:"text-xs text-slate-500"},ye={class:"text-[10px] text-slate-400 mt-1"},ve=["disabled"],we={key:0,class:"material-symbols-outlined animate-spin text-[18px]"},ke={class:"space-y-4"},_e={class:"bg-amber-50 dark:bg-amber-900/20 p-4 rounded-xl flex gap-3 text-amber-800 dark:text-amber-200"},Me={class:"text-sm font-medium leading-relaxed"},Ce={class:"flex gap-3"},Ne=["disabled"],Je={key:0,class:"material-symbols-outlined animate-spin text-[18px]"};function Te(s,t,c,u,a,n){const J=g("Head"),T=g("Toast"),P=g("PullToRefresh"),k=g("Link"),v=g("Modal");return l(),i(m,null,[f(J,{title:"لوحة التحكم - مقدم الخدمة"}),f(T),e("div",E,[e("div",V,[e("div",B,[e("div",I,[e("div",{class:"bg-center bg-no-repeat bg-cover rounded-full size-10 ring-2 ring-primary/20",style:_(`background-image: url('${n.user.photo||"https://ui-avatars.com/api/?name="+n.user.name}');`)},null,4),t[19]||(t[19]=e("div",{class:"absolute bottom-0 right-0 size-3 bg-green-500 rounded-full border-2 border-white dark:border-background-dark"},null,-1))]),e("div",null,[t[20]||(t[20]=e("h2",{class:"text-slate-900 dark:text-white text-lg font-bold leading-tight"},"لوحة التحكم",-1)),e("p",O,"مرحباً، "+r(n.user.name?.split(" ")[0]),1)])]),e("div",H,[e("button",{onClick:t[0]||(t[0]=o=>{a.showNotificationsModal=!0,n.loadNotifications()}),class:"relative flex items-center justify-center rounded-full size-10 bg-white dark:bg-slate-800 shadow-sm border border-slate-200 dark:border-slate-700 text-slate-600 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors"},[t[21]||(t[21]=e("span",{class:"material-symbols-outlined text-[24px]"},"notifications",-1)),a.unreadNotificationsCount>0?(l(),i("span",G)):d("",!0)])])]),e("div",K,[f(P,{onRefresh:n.triggerRefresh,class:"h-full"},{default:b(()=>[e("div",Q,[e("div",W,[e("label",{onClick:t[1]||(t[1]=o=>n.switchToTab("available")),class:"group relative flex cursor-pointer h-full flex-1 items-center justify-center overflow-hidden rounded-lg px-2 transition-all duration-200"},[e("span",{class:x(["relative z-10 truncate text-sm font-semibold transition-colors",a.activeTab==="available"?"text-white":"text-slate-500 dark:text-slate-400"])},"الطلبات المتاحة",2),a.activeTab==="available"?(l(),i("div",X)):d("",!0)]),e("label",{onClick:t[2]||(t[2]=o=>n.switchToTab("myjobs")),class:"group relative flex cursor-pointer h-full flex-1 items-center justify-center overflow-hidden rounded-lg px-2 transition-all duration-200"},[e("span",{class:x(["relative z-10 truncate text-sm font-semibold transition-colors",a.activeTab==="myjobs"?"text-white":"text-slate-500 dark:text-slate-400"])},"أعمالي",2),a.activeTab==="myjobs"?(l(),i("div",Y)):d("",!0)]),e("label",{onClick:t[3]||(t[3]=o=>n.switchToTab("reviews")),class:"group relative flex cursor-pointer h-full flex-1 items-center justify-center overflow-hidden rounded-lg px-2 transition-all duration-200"},[e("span",{class:x(["relative z-10 truncate text-sm font-semibold transition-colors",a.activeTab==="reviews"?"text-white":"text-slate-500 dark:text-slate-400"])},"التقييمات",2),a.activeTab==="reviews"?(l(),i("div",Z)):d("",!0)])])]),e("div",j,[e("div",$,[t[22]||(t[22]=e("div",{class:"flex items-center gap-2 mb-1"},[e("span",{class:"material-symbols-outlined text-green-500 text-xl"},"payments"),e("span",{class:"text-xs font-medium text-slate-500 dark:text-slate-400"},"الأرباح اليوم")],-1)),e("p",tt,r(a.stats.today_earnings||0)+" ج.م",1)]),e("div",et,[t[24]||(t[24]=e("div",{class:"flex items-center gap-2 mb-1"},[e("span",{class:"material-symbols-outlined text-primary text-xl"},"star"),e("span",{class:"text-xs font-medium text-slate-500 dark:text-slate-400"},"التقييم")],-1)),e("p",st,[h(r(a.stats.average_rating?Number(a.stats.average_rating).toFixed(1):"0.0")+" ",1),t[23]||(t[23]=e("span",{class:"text-xs font-normal text-slate-400"},"/ 5.0",-1))])])]),e("div",ot,[e("h3",at,r(a.activeTab==="available"?"فرص جديدة":a.activeTab==="myjobs"?"أعمالي الحالية":"آراء العملاء"),1)]),e("div",it,[a.loading?(l(),i("div",lt,[...t[25]||(t[25]=[e("span",{class:"material-symbols-outlined text-4xl animate-spin"},"progress_activity",-1)])])):a.activeTab==="available"?(l(),i(m,{key:1},[a.availableJobs.length===0?(l(),i("div",rt,[...t[26]||(t[26]=[e("div",{class:"size-16 rounded-full bg-slate-200 dark:bg-slate-800 flex items-center justify-center mb-4"},[e("span",{class:"material-symbols-outlined text-3xl text-slate-400"},"check_circle")],-1),e("p",{class:"text-slate-500 dark:text-slate-400 text-sm"},"لا توجد طلبات متاحة حالياً.",-1)])])):d("",!0),(l(!0),i(m,null,y(a.availableJobs,o=>(l(),i("div",{key:o.id,class:"flex flex-col rounded-xl bg-white dark:bg-slate-800 shadow-sm border border-slate-100 dark:border-slate-700 overflow-hidden group"},[e("div",nt,[e("div",dt,[e("div",null,[e("div",ct,[e("div",ut,[e("span",pt,r(o.category?.icon),1),e("span",ft,r(o.category?.name),1)])]),e("h3",mt,r(o.resident?.name),1),e("div",xt,[e("div",bt,[t[27]||(t[27]=e("span",{class:"material-symbols-outlined text-[16px]"},"location_on",-1)),e("p",ht,r(o.resident?.block_no?`مبنى ${o.resident.block_no}، الطابق ${o.resident.floor||"-"}، شقة ${o.resident.apt_no}`:"العنوان غير محدد"),1)]),o.resident?.compound?(l(),i("div",gt,[t[29]||(t[29]=e("span",{class:"material-symbols-outlined text-[14px]"},"apartment",-1)),e("span",null,r(o.resident.compound.name),1),o.resident.compound.location_url?(l(),i("a",{key:0,href:o.resident.compound.location_url,target:"_blank",class:"text-primary hover:underline flex items-center gap-0.5 mr-2 font-bold",onClick:t[4]||(t[4]=M(()=>{},["stop"]))},[...t[28]||(t[28]=[e("span",{class:"material-symbols-outlined text-[14px]"},"map",-1),h(" الموقع ",-1)])],8,yt)):d("",!0)])):d("",!0)])]),e("div",vt,[t[30]||(t[30]=e("span",{class:"material-symbols-outlined text-[14px]"},"schedule",-1)),h(" "+r(n.formatDate(o.created_at)),1)])]),o.delivery_method?(l(),i("div",wt,[t[31]||(t[31]=e("span",{class:"material-symbols-outlined text-[16px]"},"directions_car",-1)),e("span",null,r(o.delivery_method),1)])):d("",!0),e("div",kt,[e("p",_t,r(o.notes||"لا توجد تفاصيل إضافية"),1)]),e("div",Mt,[t[32]||(t[32]=e("button",{class:"flex-1 h-10 rounded-lg border border-slate-200 dark:border-slate-600 text-slate-700 dark:text-slate-200 font-medium text-sm hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors"}," تجاهل ",-1)),e("button",{onClick:w=>n.openProposalModal(o),class:"flex-[2] h-10 rounded-lg bg-primary text-white font-medium text-sm shadow-md shadow-blue-500/20 hover:bg-blue-600 transition-colors flex items-center justify-center gap-2"},[o.proposals&&o.proposals.length>0?(l(),i("span",Nt,"تعديل العرض ("+r(o.proposals[0].price)+" ج.م)",1)):(l(),i("span",Jt,"تقديم عرض")),e("span",Tt,r(o.proposals&&o.proposals.length>0?"edit":"arrow_back"),1)],8,Ct)])])]))),128))],64)):a.activeTab==="myjobs"?(l(),i(m,{key:2},[e("div",Pt,[e("button",{onClick:t[5]||(t[5]=o=>n.setMyJobsFilter("active")),class:x(["shrink-0 h-8 px-4 rounded-full text-sm font-semibold shadow-sm transition-colors",a.myJobsFilter==="active"?"bg-slate-900 dark:bg-white text-white dark:text-slate-900":"bg-white dark:bg-surface-dark border border-slate-200 dark:border-slate-700 text-slate-600 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-800"])}," الأعمال النشطة ",2),e("button",{onClick:t[6]||(t[6]=o=>n.setMyJobsFilter("completed")),class:x(["shrink-0 h-8 px-4 rounded-full text-sm font-semibold shadow-sm transition-colors",a.myJobsFilter==="completed"?"bg-slate-900 dark:bg-white text-white dark:text-slate-900":"bg-white dark:bg-surface-dark border border-slate-200 dark:border-slate-700 text-slate-600 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-800"])}," مكتمل ",2)]),n.filteredMyJobs.length===0?(l(),i("div",Rt,[t[33]||(t[33]=e("div",{class:"size-16 rounded-full bg-slate-200 dark:bg-slate-800 flex items-center justify-center mb-4"},[e("span",{class:"material-symbols-outlined text-3xl text-slate-400"},"work_off")],-1)),e("p",Ft,"ليس لديك أعمال "+r(a.myJobsFilter==="active"?"نشطة":"مكتملة")+".",1)])):d("",!0),(l(!0),i(m,null,y(n.filteredMyJobs,o=>(l(),i("div",{key:o.id,class:"flex flex-col rounded-xl bg-white dark:bg-slate-800 shadow-sm border border-slate-100 dark:border-slate-700 overflow-hidden p-4 gap-3"},[e("div",qt,[e("div",null,[e("span",zt,r(o.category?.name),1),e("h4",Ut,r(o.resident?.name),1),e("a",{href:`tel:${o.resident?.phone}`,class:"flex items-center gap-1 text-sm text-slate-500 mt-1 hover:text-primary"},[t[34]||(t[34]=e("span",{class:"material-symbols-outlined text-[16px]"},"call",-1)),h(" "+r(o.resident?.phone),1)],8,St),e("div",At,[e("p",Dt,[t[35]||(t[35]=e("span",{class:"material-symbols-outlined text-[14px]"},"location_on",-1)),h(" "+r(o.resident?.block_no?`مبنى ${o.resident.block_no}، الطابق ${o.resident.floor||"-"}، شقة ${o.resident.apt_no}`:"العنوان غير محدد"),1)]),o.resident?.compound?(l(),i("div",Lt,[t[37]||(t[37]=e("span",{class:"material-symbols-outlined text-[14px]"},"apartment",-1)),e("span",null,r(o.resident.compound.name),1),o.resident.compound.location_url?(l(),i("a",{key:0,href:o.resident.compound.location_url,target:"_blank",class:"text-primary hover:underline flex items-center gap-0.5 mr-2 font-bold",onClick:t[7]||(t[7]=M(()=>{},["stop"]))},[...t[36]||(t[36]=[e("span",{class:"material-symbols-outlined text-[14px]"},"map",-1),h(" الموقع ",-1)])],8,Et)):d("",!0)])):d("",!0)])]),e("span",{class:x(["px-2.5 py-1 rounded-full text-xs font-bold",{"bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300":o.status==="in_progress","bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300":o.status==="accepted_offer","bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300":o.status==="completed"}])},r(o.status==="in_progress"?"جاري التنفيذ":o.status==="completed"?"مكتمل":"بانتظار البدء"),3)]),o.delivery_method?(l(),i("div",Vt,[t[38]||(t[38]=e("span",{class:"material-symbols-outlined text-[16px]"},"directions_car",-1)),e("span",null,r(o.delivery_method),1)])):d("",!0),e("div",Bt,[e("span",It,r(o.accepted_proposal?.price)+" ج.م",1),o.status!=="completed"?(l(),i("div",Ot,[o.status==="accepted_offer"?(l(),i("button",{key:0,onClick:w=>n.updateJobStatus(o.id,"in_progress"),class:"px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-bold shadow-md hover:bg-blue-700 transition-colors"},"بدء العمل",8,Ht)):d("",!0),o.status==="in_progress"?(l(),i("button",{key:1,onClick:w=>n.updateJobStatus(o.id,"completed"),class:"px-4 py-2 bg-green-600 text-white rounded-lg text-sm font-bold shadow-md hover:bg-green-700 transition-colors"},"إكمال",8,Gt)):d("",!0)])):d("",!0)])]))),128))],64)):a.activeTab==="reviews"?(l(),i(m,{key:3},[a.reviews.length===0?(l(),i("div",Kt,[...t[39]||(t[39]=[e("div",{class:"size-16 rounded-full bg-slate-200 dark:bg-slate-800 flex items-center justify-center mb-4"},[e("span",{class:"material-symbols-outlined text-3xl text-slate-400"},"star_rate")],-1),e("p",{class:"text-slate-500 dark:text-slate-400 text-sm"},"لا توجد تقييمات بعد.",-1)])])):(l(),i("div",Qt,[(l(!0),i(m,null,y(a.reviews,o=>(l(),i("div",{key:o.id,class:"flex flex-col rounded-xl bg-white dark:bg-slate-800 shadow-sm border border-slate-100 dark:border-slate-700 overflow-hidden p-4 gap-3"},[e("div",Wt,[e("div",Xt,[e("div",{class:"size-10 rounded-full bg-slate-100 dark:bg-slate-700 bg-cover bg-center",style:_(`background-image: url('${o.request?.resident?.photo||"https://ui-avatars.com/api/?name="+o.request?.resident?.name}');`)},null,4),e("div",null,[e("h4",Yt,r(o.request?.resident?.name),1),e("p",Zt,r(n.formatDate(o.created_at)),1)])]),e("div",jt,[e("span",$t,r(o.rating),1),t[40]||(t[40]=e("span",{class:"material-symbols-outlined text-[16px] text-amber-500 filled"},"star",-1))])]),o.comment?(l(),i("p",te,[t[41]||(t[41]=e("span",{class:"material-symbols-outlined absolute top-1 right-2 text-slate-200 dark:text-slate-700 text-3xl opacity-30"},"format_quote",-1)),e("span",ee,r(o.comment),1)])):d("",!0),e("div",se,[e("span",oe,r(o.request?.category?.name),1)])]))),128)),a.hasMoreReviews?(l(),i("button",{key:0,onClick:t[8]||(t[8]=(...o)=>n.loadMoreReviews&&n.loadMoreReviews(...o)),class:"w-full py-3 text-sm font-bold text-primary bg-primary/5 hover:bg-primary/10 rounded-xl transition-colors"}," تحميل المزيد ")):d("",!0)]))],64)):d("",!0)])]),_:1},8,["onRefresh"])]),e("nav",ae,[e("div",ie,[f(k,{href:"/dashboard",class:"flex flex-col items-center justify-center flex-1 h-full gap-1 text-primary"},{default:b(()=>[...t[42]||(t[42]=[e("span",{class:"material-symbols-outlined filled"},"home",-1),e("span",{class:"text-[10px] font-medium"},"الرئيسية",-1)])]),_:1}),f(k,{href:"/settings",class:"flex flex-col items-center justify-center flex-1 h-full gap-1 text-slate-400 dark:text-slate-500 hover:text-slate-600 dark:hover:text-slate-300 transition-colors"},{default:b(()=>[...t[43]||(t[43]=[e("span",{class:"material-symbols-outlined"},"person",-1),e("span",{class:"text-[10px] font-medium"},"الحساب",-1)])]),_:1})])]),f(v,{show:a.showProposalModal,title:"تقديم عرض سعر",onClose:t[12]||(t[12]=o=>a.showProposalModal=!1)},{default:b(()=>[e("div",le,[e("div",re,[t[44]||(t[44]=e("label",{class:"text-sm font-bold text-slate-900 dark:text-white"},"السعر المقترح (ج.م)",-1)),C(e("input",{"onUpdate:modelValue":t[9]||(t[9]=o=>a.proposalForm.price=o),type:"number",class:"w-full h-12 px-4 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-900 dark:text-white focus:ring-2 focus:ring-primary/50",placeholder:"0.00"},null,512),[[N,a.proposalForm.price]])]),e("div",ne,[t[45]||(t[45]=e("label",{class:"text-sm font-bold text-slate-900 dark:text-white"},"ملاحظات العرض",-1)),C(e("textarea",{"onUpdate:modelValue":t[10]||(t[10]=o=>a.proposalForm.notes=o),class:"w-full h-24 p-3 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-900 dark:text-white focus:ring-2 focus:ring-primary/50 resize-none",placeholder:"اكتب تفاصيل عرضك هنا..."},null,512),[[N,a.proposalForm.notes]])]),e("button",{onClick:t[11]||(t[11]=(...o)=>n.submitProposal&&n.submitProposal(...o)),disabled:a.submittingProposal||!a.proposalForm.price,class:"w-full py-3 bg-primary text-white font-bold rounded-xl shadow-lg shadow-primary/20 flex items-center justify-center gap-2"},[a.submittingProposal?(l(),i("span",ce,"progress_activity")):d("",!0),t[46]||(t[46]=e("span",null,"إرسال العرض",-1))],8,de)])]),_:1},8,["show"]),f(v,{show:a.showNotificationsModal,title:"الإشعارات",onClose:t[15]||(t[15]=o=>a.showNotificationsModal=!1)},{default:b(()=>[a.notifications.length>0?(l(),i("div",ue,[t[47]||(t[47]=e("h3",{class:"text-xs font-bold text-slate-400 uppercase tracking-wider"},"سجل التنبيهات",-1)),a.unreadNotificationsCount>0?(l(),i("button",{key:0,onClick:t[13]||(t[13]=(...o)=>n.markAllNotificationsAsRead&&n.markAllNotificationsAsRead(...o)),class:"text-xs font-bold text-primary hover:underline"},"تحديد الكل كمقروء")):d("",!0)])):d("",!0),e("div",pe,[a.loadingNotifications?(l(),i("div",fe,[...t[48]||(t[48]=[e("span",{class:"material-symbols-outlined text-5xl animate-spin"},"progress_activity",-1),e("p",{class:"mt-3 text-sm font-medium"},"جاري تحميل الإشعارات...",-1)])])):a.notifications.length===0?(l(),i("div",me,[...t[49]||(t[49]=[e("span",{class:"material-symbols-outlined text-4xl"},"notifications_off",-1),e("p",{class:"mt-2"},"لا توجد إشعارات",-1)])])):d("",!0),(l(!0),i(m,null,y(a.notifications,o=>(l(),i("div",{key:o.id,onClick:w=>n.handleNotificationClick(o),class:x(["flex gap-3 p-3 rounded-xl cursor-pointer hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors",o.is_read?"bg-slate-50 dark:bg-slate-800/50":"bg-primary/5 border border-primary/20"])},[t[50]||(t[50]=e("div",{class:"size-10 rounded-full flex items-center justify-center flex-shrink-0 bg-white shadow-sm text-primary"},[e("span",{class:"material-symbols-outlined"},"notifications")],-1)),e("div",be,[e("h4",he,r(o.title),1),e("p",ge,r(o.body),1),e("p",ye,r(n.formatDate(o.created_at)),1)])],10,xe))),128)),a.nextNotificationsUrl?(l(),i("button",{key:2,onClick:t[14]||(t[14]=(...o)=>n.loadMoreNotifications&&n.loadMoreNotifications(...o)),disabled:a.loadingMoreNotifications,class:"w-full mt-2 py-3 text-sm font-bold text-primary bg-primary/10 dark:bg-primary/20 hover:bg-primary/20 rounded-xl transition-colors flex items-center justify-center gap-2"},[a.loadingMoreNotifications?(l(),i("span",we,"progress_activity")):d("",!0),e("span",null,r(a.loadingMoreNotifications?"جاري التحميل...":"تحميل المزيد"),1)],8,ve)):d("",!0)])]),_:1},8,["show"]),f(v,{show:a.showConfirmModal,title:"تأكيد الإجراء",onClose:t[18]||(t[18]=o=>a.showConfirmModal=!1)},{default:b(()=>[e("div",ke,[e("div",_e,[t[51]||(t[51]=e("span",{class:"material-symbols-outlined text-2xl flex-shrink-0"},"warning",-1)),e("p",Me,r(a.confirmMessage),1)]),e("div",Ce,[e("button",{onClick:t[16]||(t[16]=o=>a.showConfirmModal=!1),class:"flex-1 py-3 text-slate-600 dark:text-slate-300 font-bold bg-slate-100 dark:bg-slate-700/50 hover:bg-slate-200 dark:hover:bg-slate-700 rounded-xl transition-colors"}," إلغاء "),e("button",{onClick:t[17]||(t[17]=(...o)=>a.confirmAction&&a.confirmAction(...o)),disabled:a.processingConfirm,class:"flex-1 py-3 bg-primary text-white font-bold rounded-xl shadow-lg shadow-primary/20 flex items-center justify-center gap-2 hover:bg-blue-600 transition-colors"},[a.processingConfirm?(l(),i("span",Je,"progress_activity")):d("",!0),t[52]||(t[52]=e("span",null,"تأكيد",-1))],8,Ne)])])]),_:1},8,["show"])])],64)}const Ue=D(L,[["render",Te],["__scopeId","data-v-c9830f57"]]);export{Ue as default};
