import{_ as J,h as P,r as v,c as l,o as i,a as m,b as t,p as z,n as w,t as r,d,e as u,i as x,F as p,f as g,g as k,w as _,v as C,m as c,u as F,l as M}from"./app-C9rhdtb3.js";import{T as A,M as R}from"./Modal-DW5crK9-.js";import{r as S}from"./firebase-3DZyrVND.js";/* empty css            */const q={name:"ProviderDashboard",components:{Head:P,Modal:R,Toast:A},data(){return{activeTab:localStorage.getItem("provider_current_tab")||"available",availableJobs:[],myJobs:[],reviews:[],reviewsPage:1,hasMoreReviews:!1,loading:!0,stats:{},showProposalModal:!1,showNotificationsModal:!1,notifications:[],nextNotificationsUrl:null,loadingMoreNotifications:!1,unreadNotificationsCount:0,selectedJob:null,proposalForm:{price:"",notes:""},submittingProposal:!1,editingProposal:null,showConfirmModal:!1,confirmMessage:"",confirmAction:null,processingConfirm:!1,myJobsFilter:"active"}},computed:{user(){const o=F();return o.props.auth?o.props.auth.user:{}},filteredMyJobs(){return this.myJobsFilter==="active"?this.myJobs.filter(o=>o.status==="accepted_offer"||o.status==="in_progress"):this.myJobs.filter(o=>o.status===this.myJobsFilter)}},mounted(){this.loadStats(),this.loadUnreadCount(),this.switchToTab(this.activeTab),S()},methods:{switchToTab(o){this.activeTab=o,localStorage.setItem("provider_current_tab",o),o==="available"?this.loadAvailableJobs():o==="myjobs"?this.loadMyJobs():o==="reviews"&&this.loadReviews(!0)},async loadStats(){try{const o=await c.get("/api/provider/stats");o.data.success&&(this.stats=o.data.stats)}catch{}},async loadAvailableJobs(){this.loading=!0;try{const o=await c.get("/api/provider/available-requests");o.data.success&&(this.availableJobs=o.data.requests.data)}catch(o){console.error(o)}finally{this.loading=!1}},async loadMyJobs(){this.loading=!0;try{const o=await c.get("/api/provider/my-jobs");o.data.success&&(this.myJobs=o.data.jobs.data)}catch(o){console.error(o)}finally{this.loading=!1}},async loadReviews(o=!0){o&&(this.reviewsPage=1,this.reviews=[]),this.loading=!0;try{const e=await c.get(`/api/provider/reviews?page=${this.reviewsPage}`);e.data.success&&(o?this.reviews=e.data.reviews.data:this.reviews=[...this.reviews,...e.data.reviews.data],this.hasMoreReviews=!!e.data.reviews.next_page_url)}catch(e){console.error(e)}finally{this.loading=!1}},loadMoreReviews(){this.reviewsPage++,this.loadReviews(!1)},openProposalModal(o){this.selectedJob=o,o.proposals&&o.proposals.length>0?(this.editingProposal=o.proposals[0],this.proposalForm={price:this.editingProposal.price,notes:this.editingProposal.notes}):(this.editingProposal=null,this.proposalForm={price:"",notes:""}),this.showProposalModal=!0},async submitProposal(){this.submittingProposal=!0;try{let o;this.editingProposal?o=await c.put(`/api/proposals/${this.editingProposal.id}`,this.proposalForm):o=await c.post(`/api/requests/${this.selectedJob.id}/proposals`,this.proposalForm),o.data.success?(window.showToast(this.editingProposal?"تم تعديل العرض بنجاح":"تم تقديم العرض بنجاح","success"),this.showProposalModal=!1,this.loadAvailableJobs()):window.showToast(o.data.message,"error")}catch(o){window.showToast("حدث خطأ","error"),console.error(o)}finally{this.submittingProposal=!1}},updateJobStatus(o,e){this.confirmMessage=e==="in_progress"?"هل تود بدء العمل الآن؟ سيتم إشعار العميل بذلك.":"هل تود تأكيد إكمال العمل؟ سيتم إشعار العميل وإتاحة التقييم.",this.showConfirmModal=!0,this.confirmAction=async()=>{this.processingConfirm=!0;try{const f=this.myJobs.find(n=>n.id===o);let b="";e==="in_progress"?b=`/api/proposals/${f.accepted_proposal?.id}/start`:b=`/api/requests/${o}/complete`;const a=await c.post(b);a.data.success?(window.showToast("تم تحديث حالة العمل","success"),this.loadMyJobs(),e==="completed"&&this.loadStats(),this.showConfirmModal=!1):(window.showToast(a.data.message||"حدث خطأ","error"),this.showConfirmModal=!1)}catch(f){console.error(f),window.showToast("حدث خطأ","error"),this.showConfirmModal=!1}finally{this.processingConfirm=!1}}},async handleNotificationClick(o){if(!o.is_read){try{c.post(`/api/notifications/${o.id}/read`)}catch{}o.is_read=!0,this.unreadNotificationsCount=Math.max(0,this.unreadNotificationsCount-1)}this.showNotificationsModal=!1,o.data&&o.data.request_id&&this.switchToTab("myjobs")},async loadNotifications(){try{const o=await c.get("/api/notifications");o.data.success&&(this.notifications=o.data.notifications.data,this.nextNotificationsUrl=o.data.notifications.next_page_url||null)}catch{}},async loadMoreNotifications(){if(!(!this.nextNotificationsUrl||this.loadingMoreNotifications)){this.loadingMoreNotifications=!0;try{const o=await c.get(this.nextNotificationsUrl);o.data.success&&(this.notifications=[...this.notifications,...o.data.notifications.data],this.nextNotificationsUrl=o.data.notifications.next_page_url||null)}catch(o){console.error(o)}finally{this.loadingMoreNotifications=!1}}},async markAllNotificationsAsRead(){try{(await c.post("/api/notifications/read-all")).data.success&&(this.notifications.forEach(e=>e.is_read=!0),this.unreadNotificationsCount=0,window.showToast("تم تحديد الكل كمقروء","success"))}catch(o){console.error(o),window.showToast("حدث خطأ","error")}},async loadUnreadCount(){try{const o=await c.get("/api/notifications/unread-count");o.data.success&&(this.unreadNotificationsCount=o.data.count)}catch{}},formatDate(o){return new Date(o).toLocaleDateString("ar-EG",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}}},D={class:"relative flex h-screen w-full flex-col overflow-hidden max-w-md mx-auto bg-background-light dark:bg-background-dark shadow-2xl font-display",dir:"rtl"},U={class:"flex items-center px-4 py-3 pb-2 justify-between z-10 bg-background-light dark:bg-background-dark sticky top-0"},V={class:"flex items-center gap-3"},B={class:"relative"},E={class:"text-slate-500 dark:text-slate-400 text-xs font-medium"},H={class:"flex items-center justify-end"},I={key:0,class:"absolute top-2 right-2.5 size-2 bg-red-500 rounded-full"},L={class:"flex-1 overflow-y-auto no-scrollbar pb-24"},G={class:"px-4 py-3 sticky top-0 z-10 bg-background-light/95 dark:bg-background-dark/95 backdrop-blur-sm"},K={class:"flex h-12 w-full items-center justify-center rounded-xl bg-slate-200 dark:bg-slate-800 p-1"},O={key:0,class:"absolute inset-0 z-0 rounded-lg bg-primary shadow-sm"},Q={key:0,class:"absolute inset-0 z-0 rounded-lg bg-primary shadow-sm"},W={key:0,class:"absolute inset-0 z-0 rounded-lg bg-primary shadow-sm"},X={class:"px-4 mb-2 grid grid-cols-2 gap-3"},Y={class:"bg-white dark:bg-slate-800 p-3 rounded-xl border border-slate-100 dark:border-slate-700 shadow-sm"},Z={class:"text-xl font-bold text-slate-900 dark:text-white"},j={class:"bg-white dark:bg-slate-800 p-3 rounded-xl border border-slate-100 dark:border-slate-700 shadow-sm"},$={class:"text-xl font-bold text-slate-900 dark:text-white"},tt={class:"px-4 pt-2 pb-2 flex justify-between items-end"},et={class:"text-base font-bold text-slate-900 dark:text-white"},st={class:"flex flex-col gap-4 px-4 pb-4"},ot={key:0,class:"text-center py-8 text-slate-400"},at={key:0,class:"flex flex-col items-center justify-center p-8 text-center opacity-60"},lt={class:"p-4 flex flex-col gap-3"},it={class:"flex justify-between items-start"},rt={class:"flex items-center gap-2 mb-1"},nt={class:"bg-white/90 dark:bg-slate-900/90 backdrop-blur px-2.5 py-1 rounded-full flex items-center gap-1 shadow-sm border border-slate-100 dark:border-slate-700"},dt={class:"material-symbols-outlined text-primary text-[16px]"},ct={class:"text-xs font-bold text-slate-800 dark:text-slate-200"},pt={class:"text-slate-900 dark:text-white text-lg font-bold leading-tight mb-1"},ut={class:"flex flex-col gap-0.5 text-slate-500 dark:text-slate-400"},xt={class:"flex items-center gap-1"},mt={class:"text-xs font-medium"},ft={key:0,class:"flex items-center gap-1 text-xs px-1"},bt=["href"],gt={class:"bg-slate-900/60 backdrop-blur px-2 py-1 rounded-md text-xs font-medium text-white flex items-center gap-1"},ht={key:0,class:"flex items-center justify-center gap-1 text-xs font-semibold text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/20 px-3 py-2 rounded-xl w-full"},yt={class:"bg-slate-50 dark:bg-slate-700/50 p-3 rounded-lg border border-slate-100 dark:border-slate-700/50"},vt={class:"text-slate-600 dark:text-slate-300 text-sm line-clamp-2"},kt={class:"pt-1 flex gap-3"},wt=["onClick"],_t={key:0},Ct={key:1},Mt={class:"material-symbols-outlined text-[18px]"},Nt={class:"flex gap-2 mb-4 overflow-x-auto no-scrollbar pb-1"},Tt={key:0,class:"flex flex-col items-center justify-center p-8 text-center opacity-60"},Jt={class:"text-slate-500 dark:text-slate-400 text-sm"},Pt={class:"flex justify-between items-start"},zt={class:"text-[10px] font-bold text-primary uppercase tracking-wider mb-1 block"},Ft={class:"font-bold text-slate-900 dark:text-white text-lg"},At=["href"],Rt={class:"mt-2 text-slate-500 dark:text-slate-400 text-xs"},St={class:"flex items-center gap-1"},qt={key:0,class:"flex items-center gap-1 mt-1"},Dt=["href"],Ut={key:0,class:"flex items-center justify-center gap-1 text-xs font-semibold text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/20 px-3 py-2 rounded-xl w-full"},Vt={class:"flex items-center justify-between pt-3 border-t border-slate-100 dark:border-slate-700"},Bt={class:"font-bold text-xl text-emerald-600"},Et={key:0,class:"flex gap-2"},Ht=["onClick"],It=["onClick"],Lt={key:0,class:"flex flex-col items-center justify-center p-8 text-center opacity-60"},Gt={key:1,class:"space-y-4"},Kt={class:"flex justify-between items-start"},Ot={class:"flex items-center gap-3"},Qt={class:"font-bold text-slate-900 dark:text-white text-sm"},Wt={class:"text-xs text-slate-400"},Xt={class:"flex items-center gap-1 bg-amber-50 dark:bg-amber-900/20 px-2 py-1 rounded-lg"},Yt={class:"font-bold text-amber-600 dark:text-amber-400 text-sm"},Zt={key:0,class:"text-sm text-slate-600 dark:text-slate-300 leading-relaxed bg-slate-50 dark:bg-slate-900/50 p-3 rounded-lg relative"},jt={class:"relative"},$t={class:"flex items-center gap-2 mt-1"},te={class:"text-[10px] font-bold px-2 py-0.5 bg-slate-100 dark:bg-slate-700 rounded text-slate-500"},ee={class:"space-y-4"},se={class:"flex flex-col gap-1.5"},oe={class:"flex flex-col gap-1.5"},ae=["disabled"],le={key:0,class:"material-symbols-outlined animate-spin"},ie={key:0,class:"flex items-center justify-between mb-4 px-1"},re={class:"space-y-3 max-h-[60vh] overflow-y-auto pr-1"},ne={key:0,class:"text-center py-8 text-slate-400"},de=["onClick"],ce={class:"flex-1"},pe={class:"text-sm font-bold"},ue={class:"text-xs text-slate-500"},xe={class:"text-[10px] text-slate-400 mt-1"},me=["disabled"],fe={key:0,class:"material-symbols-outlined animate-spin text-[18px]"},be={class:"space-y-4"},ge={class:"bg-amber-50 dark:bg-amber-900/20 p-4 rounded-xl flex gap-3 text-amber-800 dark:text-amber-200"},he={class:"text-sm font-medium leading-relaxed"},ye={class:"flex gap-3"},ve=["disabled"],ke={key:0,class:"material-symbols-outlined animate-spin text-[18px]"};function we(o,e,f,b,a,n){const N=v("Head"),T=v("Toast"),h=v("Modal");return i(),l(p,null,[m(N,{title:"لوحة التحكم - مقدم الخدمة"}),m(T),t("div",D,[t("div",U,[t("div",V,[t("div",B,[t("div",{class:"bg-center bg-no-repeat bg-cover rounded-full size-10 ring-2 ring-primary/20",style:w(`background-image: url('${n.user.photo||"https://ui-avatars.com/api/?name="+n.user.name}');`)},null,4),e[19]||(e[19]=t("div",{class:"absolute bottom-0 right-0 size-3 bg-green-500 rounded-full border-2 border-white dark:border-background-dark"},null,-1))]),t("div",null,[e[20]||(e[20]=t("h2",{class:"text-slate-900 dark:text-white text-lg font-bold leading-tight"},"لوحة التحكم",-1)),t("p",E,"مرحباً، "+r(n.user.name?.split(" ")[0]),1)])]),t("div",H,[t("button",{onClick:e[0]||(e[0]=s=>{a.showNotificationsModal=!0,n.loadNotifications()}),class:"relative flex items-center justify-center rounded-full size-10 bg-white dark:bg-slate-800 shadow-sm border border-slate-200 dark:border-slate-700 text-slate-600 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors"},[e[21]||(e[21]=t("span",{class:"material-symbols-outlined text-[24px]"},"notifications",-1)),a.unreadNotificationsCount>0?(i(),l("span",I)):d("",!0)])])]),t("div",L,[t("div",G,[t("div",K,[t("label",{onClick:e[1]||(e[1]=s=>n.switchToTab("available")),class:"group relative flex cursor-pointer h-full flex-1 items-center justify-center overflow-hidden rounded-lg px-2 transition-all duration-200"},[t("span",{class:u(["relative z-10 truncate text-sm font-semibold transition-colors",a.activeTab==="available"?"text-white":"text-slate-500 dark:text-slate-400"])},"الطلبات المتاحة",2),a.activeTab==="available"?(i(),l("div",O)):d("",!0)]),t("label",{onClick:e[2]||(e[2]=s=>n.switchToTab("myjobs")),class:"group relative flex cursor-pointer h-full flex-1 items-center justify-center overflow-hidden rounded-lg px-2 transition-all duration-200"},[t("span",{class:u(["relative z-10 truncate text-sm font-semibold transition-colors",a.activeTab==="myjobs"?"text-white":"text-slate-500 dark:text-slate-400"])},"أعمالي",2),a.activeTab==="myjobs"?(i(),l("div",Q)):d("",!0)]),t("label",{onClick:e[3]||(e[3]=s=>n.switchToTab("reviews")),class:"group relative flex cursor-pointer h-full flex-1 items-center justify-center overflow-hidden rounded-lg px-2 transition-all duration-200"},[t("span",{class:u(["relative z-10 truncate text-sm font-semibold transition-colors",a.activeTab==="reviews"?"text-white":"text-slate-500 dark:text-slate-400"])},"التقييمات",2),a.activeTab==="reviews"?(i(),l("div",W)):d("",!0)])])]),t("div",X,[t("div",Y,[e[22]||(e[22]=t("div",{class:"flex items-center gap-2 mb-1"},[t("span",{class:"material-symbols-outlined text-green-500 text-xl"},"payments"),t("span",{class:"text-xs font-medium text-slate-500 dark:text-slate-400"},"الأرباح اليوم")],-1)),t("p",Z,r(a.stats.today_earnings||0)+" ج.م",1)]),t("div",j,[e[24]||(e[24]=t("div",{class:"flex items-center gap-2 mb-1"},[t("span",{class:"material-symbols-outlined text-primary text-xl"},"star"),t("span",{class:"text-xs font-medium text-slate-500 dark:text-slate-400"},"التقييم")],-1)),t("p",$,[x(r(a.stats.average_rating?Number(a.stats.average_rating).toFixed(1):"0.0")+" ",1),e[23]||(e[23]=t("span",{class:"text-xs font-normal text-slate-400"},"/ 5.0",-1))])])]),t("div",tt,[t("h3",et,r(a.activeTab==="available"?"فرص جديدة":a.activeTab==="myjobs"?"أعمالي الحالية":"آراء العملاء"),1)]),t("div",st,[a.loading?(i(),l("div",ot,[...e[25]||(e[25]=[t("span",{class:"material-symbols-outlined text-4xl animate-spin"},"progress_activity",-1)])])):a.activeTab==="available"?(i(),l(p,{key:1},[a.availableJobs.length===0?(i(),l("div",at,[...e[26]||(e[26]=[t("div",{class:"size-16 rounded-full bg-slate-200 dark:bg-slate-800 flex items-center justify-center mb-4"},[t("span",{class:"material-symbols-outlined text-3xl text-slate-400"},"check_circle")],-1),t("p",{class:"text-slate-500 dark:text-slate-400 text-sm"},"لا توجد طلبات متاحة حالياً.",-1)])])):d("",!0),(i(!0),l(p,null,g(a.availableJobs,s=>(i(),l("div",{key:s.id,class:"flex flex-col rounded-xl bg-white dark:bg-slate-800 shadow-sm border border-slate-100 dark:border-slate-700 overflow-hidden group"},[t("div",lt,[t("div",it,[t("div",null,[t("div",rt,[t("div",nt,[t("span",dt,r(s.category?.icon),1),t("span",ct,r(s.category?.name),1)])]),t("h3",pt,r(s.resident?.name),1),t("div",ut,[t("div",xt,[e[27]||(e[27]=t("span",{class:"material-symbols-outlined text-[16px]"},"location_on",-1)),t("p",mt,r(s.resident?.block_no?`مبنى ${s.resident.block_no}، الطابق ${s.resident.floor||"-"}، شقة ${s.resident.apt_no}`:"العنوان غير محدد"),1)]),s.resident?.compound?(i(),l("div",ft,[e[29]||(e[29]=t("span",{class:"material-symbols-outlined text-[14px]"},"apartment",-1)),t("span",null,r(s.resident.compound.name),1),s.resident.compound.location_url?(i(),l("a",{key:0,href:s.resident.compound.location_url,target:"_blank",class:"text-primary hover:underline flex items-center gap-0.5 mr-2 font-bold",onClick:e[4]||(e[4]=M(()=>{},["stop"]))},[...e[28]||(e[28]=[t("span",{class:"material-symbols-outlined text-[14px]"},"map",-1),x(" الموقع ",-1)])],8,bt)):d("",!0)])):d("",!0)])]),t("div",gt,[e[30]||(e[30]=t("span",{class:"material-symbols-outlined text-[14px]"},"schedule",-1)),x(" "+r(n.formatDate(s.created_at)),1)])]),s.delivery_method?(i(),l("div",ht,[e[31]||(e[31]=t("span",{class:"material-symbols-outlined text-[16px]"},"directions_car",-1)),t("span",null,r(s.delivery_method),1)])):d("",!0),t("div",yt,[t("p",vt,r(s.notes||"لا توجد تفاصيل إضافية"),1)]),t("div",kt,[e[32]||(e[32]=t("button",{class:"flex-1 h-10 rounded-lg border border-slate-200 dark:border-slate-600 text-slate-700 dark:text-slate-200 font-medium text-sm hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors"}," تجاهل ",-1)),t("button",{onClick:y=>n.openProposalModal(s),class:"flex-[2] h-10 rounded-lg bg-primary text-white font-medium text-sm shadow-md shadow-blue-500/20 hover:bg-blue-600 transition-colors flex items-center justify-center gap-2"},[s.proposals&&s.proposals.length>0?(i(),l("span",_t,"تعديل العرض ("+r(s.proposals[0].price)+" ج.م)",1)):(i(),l("span",Ct,"تقديم عرض")),t("span",Mt,r(s.proposals&&s.proposals.length>0?"edit":"arrow_back"),1)],8,wt)])])]))),128))],64)):a.activeTab==="myjobs"?(i(),l(p,{key:2},[t("div",Nt,[t("button",{onClick:e[5]||(e[5]=s=>a.myJobsFilter="active"),class:u(["shrink-0 h-8 px-4 rounded-full text-sm font-semibold shadow-sm transition-colors",a.myJobsFilter==="active"?"bg-slate-900 dark:bg-white text-white dark:text-slate-900":"bg-white dark:bg-surface-dark border border-slate-200 dark:border-slate-700 text-slate-600 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-800"])}," الأعمال النشطة ",2),t("button",{onClick:e[6]||(e[6]=s=>a.myJobsFilter="completed"),class:u(["shrink-0 h-8 px-4 rounded-full text-sm font-semibold shadow-sm transition-colors",a.myJobsFilter==="completed"?"bg-slate-900 dark:bg-white text-white dark:text-slate-900":"bg-white dark:bg-surface-dark border border-slate-200 dark:border-slate-700 text-slate-600 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-800"])}," مكتمل ",2)]),n.filteredMyJobs.length===0?(i(),l("div",Tt,[e[33]||(e[33]=t("div",{class:"size-16 rounded-full bg-slate-200 dark:bg-slate-800 flex items-center justify-center mb-4"},[t("span",{class:"material-symbols-outlined text-3xl text-slate-400"},"work_off")],-1)),t("p",Jt,"ليس لديك أعمال "+r(a.myJobsFilter==="active"?"نشطة":"مكتملة")+".",1)])):d("",!0),(i(!0),l(p,null,g(n.filteredMyJobs,s=>(i(),l("div",{key:s.id,class:"flex flex-col rounded-xl bg-white dark:bg-slate-800 shadow-sm border border-slate-100 dark:border-slate-700 overflow-hidden p-4 gap-3"},[t("div",Pt,[t("div",null,[t("span",zt,r(s.category?.name),1),t("h4",Ft,r(s.resident?.name),1),t("a",{href:`tel:${s.resident?.phone}`,class:"flex items-center gap-1 text-sm text-slate-500 mt-1 hover:text-primary"},[e[34]||(e[34]=t("span",{class:"material-symbols-outlined text-[16px]"},"call",-1)),x(" "+r(s.resident?.phone),1)],8,At),t("div",Rt,[t("p",St,[e[35]||(e[35]=t("span",{class:"material-symbols-outlined text-[14px]"},"location_on",-1)),x(" "+r(s.resident?.block_no?`مبنى ${s.resident.block_no}، الطابق ${s.resident.floor||"-"}، شقة ${s.resident.apt_no}`:"العنوان غير محدد"),1)]),s.resident?.compound?(i(),l("div",qt,[e[37]||(e[37]=t("span",{class:"material-symbols-outlined text-[14px]"},"apartment",-1)),t("span",null,r(s.resident.compound.name),1),s.resident.compound.location_url?(i(),l("a",{key:0,href:s.resident.compound.location_url,target:"_blank",class:"text-primary hover:underline flex items-center gap-0.5 mr-2 font-bold",onClick:e[7]||(e[7]=M(()=>{},["stop"]))},[...e[36]||(e[36]=[t("span",{class:"material-symbols-outlined text-[14px]"},"map",-1),x(" الموقع ",-1)])],8,Dt)):d("",!0)])):d("",!0)])]),t("span",{class:u(["px-2.5 py-1 rounded-full text-xs font-bold",{"bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300":s.status==="in_progress","bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300":s.status==="accepted_offer","bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300":s.status==="completed"}])},r(s.status==="in_progress"?"جاري التنفيذ":s.status==="completed"?"مكتمل":"بانتظار البدء"),3)]),s.delivery_method?(i(),l("div",Ut,[e[38]||(e[38]=t("span",{class:"material-symbols-outlined text-[16px]"},"directions_car",-1)),t("span",null,r(s.delivery_method),1)])):d("",!0),t("div",Vt,[t("span",Bt,r(s.accepted_proposal?.price)+" ج.م",1),s.status!=="completed"?(i(),l("div",Et,[s.status==="accepted_offer"?(i(),l("button",{key:0,onClick:y=>n.updateJobStatus(s.id,"in_progress"),class:"px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-bold shadow-md hover:bg-blue-700 transition-colors"},"بدء العمل",8,Ht)):d("",!0),s.status==="in_progress"?(i(),l("button",{key:1,onClick:y=>n.updateJobStatus(s.id,"completed"),class:"px-4 py-2 bg-green-600 text-white rounded-lg text-sm font-bold shadow-md hover:bg-green-700 transition-colors"},"إكمال",8,It)):d("",!0)])):d("",!0)])]))),128))],64)):a.activeTab==="reviews"?(i(),l(p,{key:3},[a.reviews.length===0?(i(),l("div",Lt,[...e[39]||(e[39]=[t("div",{class:"size-16 rounded-full bg-slate-200 dark:bg-slate-800 flex items-center justify-center mb-4"},[t("span",{class:"material-symbols-outlined text-3xl text-slate-400"},"star_rate")],-1),t("p",{class:"text-slate-500 dark:text-slate-400 text-sm"},"لا توجد تقييمات بعد.",-1)])])):(i(),l("div",Gt,[(i(!0),l(p,null,g(a.reviews,s=>(i(),l("div",{key:s.id,class:"flex flex-col rounded-xl bg-white dark:bg-slate-800 shadow-sm border border-slate-100 dark:border-slate-700 overflow-hidden p-4 gap-3"},[t("div",Kt,[t("div",Ot,[t("div",{class:"size-10 rounded-full bg-slate-100 dark:bg-slate-700 bg-cover bg-center",style:w(`background-image: url('${s.request?.resident?.photo||"https://ui-avatars.com/api/?name="+s.request?.resident?.name}');`)},null,4),t("div",null,[t("h4",Qt,r(s.request?.resident?.name),1),t("p",Wt,r(n.formatDate(s.created_at)),1)])]),t("div",Xt,[t("span",Yt,r(s.rating),1),e[40]||(e[40]=t("span",{class:"material-symbols-outlined text-[16px] text-amber-500 filled"},"star",-1))])]),s.comment?(i(),l("p",Zt,[e[41]||(e[41]=t("span",{class:"material-symbols-outlined absolute top-1 right-2 text-slate-200 dark:text-slate-700 text-3xl opacity-30"},"format_quote",-1)),t("span",jt,r(s.comment),1)])):d("",!0),t("div",$t,[t("span",te,r(s.request?.category?.name),1)])]))),128)),a.hasMoreReviews?(i(),l("button",{key:0,onClick:e[8]||(e[8]=(...s)=>n.loadMoreReviews&&n.loadMoreReviews(...s)),class:"w-full py-3 text-sm font-bold text-primary bg-primary/5 hover:bg-primary/10 rounded-xl transition-colors"}," تحميل المزيد ")):d("",!0)]))],64)):d("",!0)])]),e[50]||(e[50]=z('<div class="h-20 bg-white dark:bg-slate-900 border-t border-slate-200 dark:border-slate-800 flex justify-around items-center pb-5 px-2 absolute bottom-0 w-full z-20" data-v-7e258e30><a href="/dashboard" class="flex flex-col items-center justify-center w-16 gap-1 text-primary" data-v-7e258e30><span class="material-symbols-outlined filled" data-v-7e258e30>home</span><span class="text-[10px] font-medium" data-v-7e258e30>الرئيسية</span></a><a href="/settings" class="flex flex-col items-center justify-center w-16 gap-1 text-slate-400 hover:text-slate-600 dark:hover:text-slate-200 transition-colors" data-v-7e258e30><span class="material-symbols-outlined" data-v-7e258e30>person</span><span class="text-[10px] font-medium" data-v-7e258e30>الحساب</span></a></div>',1)),m(h,{show:a.showProposalModal,title:"تقديم عرض سعر",onClose:e[12]||(e[12]=s=>a.showProposalModal=!1)},{default:k(()=>[t("div",ee,[t("div",se,[e[42]||(e[42]=t("label",{class:"text-sm font-bold text-slate-900 dark:text-white"},"السعر المقترح (ج.م)",-1)),_(t("input",{"onUpdate:modelValue":e[9]||(e[9]=s=>a.proposalForm.price=s),type:"number",class:"w-full h-12 px-4 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-900 dark:text-white focus:ring-2 focus:ring-primary/50",placeholder:"0.00"},null,512),[[C,a.proposalForm.price]])]),t("div",oe,[e[43]||(e[43]=t("label",{class:"text-sm font-bold text-slate-900 dark:text-white"},"ملاحظات العرض",-1)),_(t("textarea",{"onUpdate:modelValue":e[10]||(e[10]=s=>a.proposalForm.notes=s),class:"w-full h-24 p-3 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-900 dark:text-white focus:ring-2 focus:ring-primary/50 resize-none",placeholder:"اكتب تفاصيل عرضك هنا..."},null,512),[[C,a.proposalForm.notes]])]),t("button",{onClick:e[11]||(e[11]=(...s)=>n.submitProposal&&n.submitProposal(...s)),disabled:a.submittingProposal||!a.proposalForm.price,class:"w-full py-3 bg-primary text-white font-bold rounded-xl shadow-lg shadow-primary/20 flex items-center justify-center gap-2"},[a.submittingProposal?(i(),l("span",le,"progress_activity")):d("",!0),e[44]||(e[44]=t("span",null,"إرسال العرض",-1))],8,ae)])]),_:1},8,["show"]),m(h,{show:a.showNotificationsModal,title:"الإشعارات",onClose:e[15]||(e[15]=s=>a.showNotificationsModal=!1)},{default:k(()=>[a.notifications.length>0?(i(),l("div",ie,[e[45]||(e[45]=t("h3",{class:"text-xs font-bold text-slate-400 uppercase tracking-wider"},"سجل التنبيهات",-1)),a.unreadNotificationsCount>0?(i(),l("button",{key:0,onClick:e[13]||(e[13]=(...s)=>n.markAllNotificationsAsRead&&n.markAllNotificationsAsRead(...s)),class:"text-xs font-bold text-primary hover:underline"},"تحديد الكل كمقروء")):d("",!0)])):d("",!0),t("div",re,[a.notifications.length===0?(i(),l("div",ne,[...e[46]||(e[46]=[t("span",{class:"material-symbols-outlined text-4xl"},"notifications_off",-1),t("p",{class:"mt-2"},"لا توجد إشعارات",-1)])])):d("",!0),(i(!0),l(p,null,g(a.notifications,s=>(i(),l("div",{key:s.id,onClick:y=>n.handleNotificationClick(s),class:u(["flex gap-3 p-3 rounded-xl cursor-pointer hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors",s.is_read?"bg-slate-50 dark:bg-slate-800/50":"bg-primary/5 border border-primary/20"])},[e[47]||(e[47]=t("div",{class:"size-10 rounded-full flex items-center justify-center flex-shrink-0 bg-white shadow-sm text-primary"},[t("span",{class:"material-symbols-outlined"},"notifications")],-1)),t("div",ce,[t("h4",pe,r(s.title),1),t("p",ue,r(s.body),1),t("p",xe,r(n.formatDate(s.created_at)),1)])],10,de))),128)),a.nextNotificationsUrl?(i(),l("button",{key:1,onClick:e[14]||(e[14]=(...s)=>n.loadMoreNotifications&&n.loadMoreNotifications(...s)),disabled:a.loadingMoreNotifications,class:"w-full mt-2 py-3 text-sm font-bold text-primary bg-primary/10 dark:bg-primary/20 hover:bg-primary/20 rounded-xl transition-colors flex items-center justify-center gap-2"},[a.loadingMoreNotifications?(i(),l("span",fe,"progress_activity")):d("",!0),t("span",null,r(a.loadingMoreNotifications?"جاري التحميل...":"تحميل المزيد"),1)],8,me)):d("",!0)])]),_:1},8,["show"]),m(h,{show:a.showConfirmModal,title:"تأكيد الإجراء",onClose:e[18]||(e[18]=s=>a.showConfirmModal=!1)},{default:k(()=>[t("div",be,[t("div",ge,[e[48]||(e[48]=t("span",{class:"material-symbols-outlined text-2xl flex-shrink-0"},"warning",-1)),t("p",he,r(a.confirmMessage),1)]),t("div",ye,[t("button",{onClick:e[16]||(e[16]=s=>a.showConfirmModal=!1),class:"flex-1 py-3 text-slate-600 dark:text-slate-300 font-bold bg-slate-100 dark:bg-slate-700/50 hover:bg-slate-200 dark:hover:bg-slate-700 rounded-xl transition-colors"}," إلغاء "),t("button",{onClick:e[17]||(e[17]=(...s)=>a.confirmAction&&a.confirmAction(...s)),disabled:a.processingConfirm,class:"flex-1 py-3 bg-primary text-white font-bold rounded-xl shadow-lg shadow-primary/20 flex items-center justify-center gap-2 hover:bg-blue-600 transition-colors"},[a.processingConfirm?(i(),l("span",ke,"progress_activity")):d("",!0),e[49]||(e[49]=t("span",null,"تأكيد",-1))],8,ve)])])]),_:1},8,["show"])])],64)}const Te=J(q,[["render",we],["__scopeId","data-v-7e258e30"]]);export{Te as default};
