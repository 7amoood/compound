const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index.esm-Cgd8yjKO.js","assets/index.esm-BJAW3Jpj.js","assets/index.esm-BnPOK2CB.js"])))=>i.map(i=>d[i]);
import{_ as h,a as c}from"./app-Sy-MfUt7.js";import{c as d,o as p,d as o,k as f,n as a,t as g,B as m,a as y}from"./vendor-DhvMcwBQ.js";const v={name:"PullToRefresh",props:{threshold:{type:Number,default:80},onRefresh:{type:Function,required:!0}},data(){return{startY:0,currentY:0,pullDelta:0,isLoading:!1,isDragging:!1,canPull:!1}},computed:{indicatorStyle(){const t=Math.min(this.pullDelta/this.threshold,1);return{height:`${this.pullDelta}px`,opacity:t,transition:this.isDragging?"none":"height 0.4s cubic-bezier(0.19, 1, 0.22, 1), opacity 0.3s ease"}},contentStyle(){return{transform:`translateY(${this.pullDelta}px)`,transition:this.isDragging?"none":"transform 0.4s cubic-bezier(0.19, 1, 0.22, 1)"}},iconRotateStyle(){return this.isLoading?{}:{transform:`rotate(${this.pullDelta>this.threshold?180:0}deg)`,transition:"transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1)"}}},mounted(){this.$refs.container.addEventListener("touchstart",this.onTouchStart,{passive:!0}),this.$refs.container.addEventListener("touchmove",this.onTouchMove,{passive:!1}),this.$refs.container.addEventListener("touchend",this.onTouchEnd,{passive:!0})},beforeUnmount(){this.$refs.container&&(this.$refs.container.removeEventListener("touchstart",this.onTouchStart),this.$refs.container.removeEventListener("touchmove",this.onTouchMove),this.$refs.container.removeEventListener("touchend",this.onTouchEnd))},methods:{onTouchStart(t){if(this.isLoading)return;const e=this.getScrollParent(this.$refs.container);let i=0;e?i=e.scrollTop:i=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop,i<=0?(this.canPull=!0,this.startY=t.touches[0].clientY):this.canPull=!1},onTouchMove(t){if(!this.canPull||this.isLoading)return;const i=t.touches[0].clientY-this.startY;i>0?(this.isDragging=!0,this.pullDelta=Math.pow(i,.85),t.cancelable&&t.preventDefault()):(this.pullDelta=0,this.isDragging=!1)},async onTouchEnd(){if(!this.canPull||this.isLoading)return;const t=this.pullDelta>=this.threshold;if(this.isDragging=!1,this.canPull=!1,t){this.isLoading=!0,this.pullDelta=60;try{await this.onRefresh()}finally{this.isLoading=!1,this.pullDelta=0}}else this.pullDelta=0},getScrollParent(t){let e=t.parentElement;for(;e;){const n=window.getComputedStyle(e).getPropertyValue("overflow-y");if((n==="auto"||n==="scroll")&&e.scrollHeight>e.clientHeight)return e;e=e.parentElement}return null}}},w={ref:"container",class:"pull-to-refresh-wrapper"};function _(t,e,i,n,r,s){return p(),d("div",w,[o("div",{class:"ptr-indicator",style:a(s.indicatorStyle)},[o("div",{class:f(["ptr-icon-box",{"ptr-loading":r.isLoading}])},[o("span",{class:"material-symbols-outlined font-bold",style:a(s.iconRotateStyle)},g(r.isLoading?"progress_activity":"arrow_downward"),5)],2)],4),o("div",{style:a(s.contentStyle),class:"ptr-content"},[m(t.$slots,"default",{},void 0)],4)],512)}const T=h(v,[["render",_],["__scopeId","data-v-fabb7063"]]),D={apiKey:"AIzaSyCf6DUu21s4qhbD2fLkSypCRDkSnCbzQCo",authDomain:"garden-city-compound.firebaseapp.com",projectId:"garden-city-compound",storageBucket:"garden-city-compound.firebasestorage.app",messagingSenderId:"358088420520",appId:"1:358088420520:web:7cdd88dc6d98d2c6f0269d"};let l=null,u=null;async function b(){if(!l){const{initializeApp:t}=await c(async()=>{const{initializeApp:i}=await import("./index.esm-Cgd8yjKO.js");return{initializeApp:i}},__vite__mapDeps([0,1])),{getMessaging:e}=await c(async()=>{const{getMessaging:i}=await import("./index.esm-BnPOK2CB.js");return{getMessaging:i}},__vite__mapDeps([2,1]));l=t(D),u=e(l)}return u}async function S(){if(!("serviceWorker"in navigator)||!("Notification"in window)){console.warn("Push is not supported");return}try{if(await Notification.requestPermission()==="granted"){const{getToken:e}=await c(async()=>{const{getToken:s}=await import("./index.esm-BnPOK2CB.js");return{getToken:s}},__vite__mapDeps([2,1])),i=await b(),n=await navigator.serviceWorker.register("/service-worker.js");await navigator.serviceWorker.ready,await new Promise(s=>setTimeout(s,300));const r=await e(i,{vapidKey:"BC6EtV4AwjM5kQj92nuF9b31rzDE1Pj7htPT6ESqa8yGD10Uln3QHrApWppge6Uexd9UsQFCdbtXvoDBR-D4-6E",serviceWorkerRegistration:n});r&&await y.post("/api/notifications/save-token",{token:r})}}catch(t){console.error("FCM Error:",t)}}export{T as P,S as r};
