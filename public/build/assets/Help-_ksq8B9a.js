import{E as D,l as U,m as h,c as o,o as r,h as u,d as e,F as x,s as y,w as m,b as d,t as n,n as b,p as w,g as k,q as v,v as q,a as p,z as P}from"./vendor-tvXOKrQx.js";import{T as z,M as H}from"./Modal-5jAOLNfD.js";import{P as N}from"./PullToRefresh-Bi2CvXHE.js";import{_ as j}from"./app-D0olpJ8b.js";/* empty css            */const I={name:"Help",components:{Head:U,Link:D,Modal:H,Toast:z,PullToRefresh:N},data(){return{activeTab:"available",tabs:[{id:"available",label:"Ø·Ù„Ø¨Ø§Øª Ù…ØªØ§Ø­Ø©"},{id:"my",label:"Ø·Ù„Ø¨Ø§ØªÙŠ"},{id:"helped",label:"Ø³Ø§Ø¹Ø¯Øª ÙÙŠÙ‡Ø§"}],requests:[],loading:!1,loadingMore:!1,nextPageUrl:null,showNewRequestModal:!1,showDetailsModal:!1,selectedRequest:null,newRequestDescription:"",submitting:!1,newComment:"",addingComment:!1}},computed:{currentUserId(){return P().props.auth?.user?.id},emptyIcon(){return{available:"volunteer_activism",my:"inbox",helped:"handshake",cancelled:"delete_sweep"}[this.activeTab]||"inbox"},emptyMessage(){return{available:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ù…Ø³Ø§Ø¹Ø¯Ø© Ø­Ø§Ù„ÙŠØ§Ù‹",my:"Ù„Ù… ØªØ·Ù„Ø¨ Ù…Ø³Ø§Ø¹Ø¯Ø© Ø¨Ø¹Ø¯",helped:"Ù„Ù… ØªØ³Ø§Ø¹Ø¯ Ø£Ø­Ø¯Ø§Ù‹ Ø¨Ø¹Ø¯",cancelled:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ù…Ù„ØºÙŠØ©"}[this.activeTab]||"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª"},canSeePhone(){if(!this.selectedRequest)return!1;const a=this.selectedRequest.requester_id===this.currentUserId,t=this.selectedRequest.helper_id===this.currentUserId;return a||t},canSeeHelperPhone(){return this.selectedRequest?this.selectedRequest.requester_id===this.currentUserId:!1},canComment(){if(!this.selectedRequest)return!1;const a=this.selectedRequest.requester_id===this.currentUserId,t=this.selectedRequest.helper_id===this.currentUserId;return a||t}},watch:{activeTab(){this.loadData()}},mounted(){this.loadData()},methods:{async loadData(){this.loading=!0,this.requests=[],this.nextPageUrl=null;try{let a="/api/help/available";this.activeTab==="my"?a="/api/help/my-requests":this.activeTab==="helped"?a="/api/help/my-helps":this.activeTab==="cancelled"&&(a="/api/help/my-requests?status=cancelled");const t=await p.get(a);t.data.success&&(this.requests=t.data.requests.data,this.nextPageUrl=t.data.requests.next_page_url)}catch(a){console.error(a)}finally{this.loading=!1}},async loadMore(){if(!(!this.nextPageUrl||this.loadingMore)){this.loadingMore=!0;try{const a=await p.get(this.nextPageUrl);a.data.success&&(this.requests.push(...a.data.requests.data),this.nextPageUrl=a.data.requests.next_page_url)}catch(a){console.error(a)}finally{this.loadingMore=!1}}},async submitNewRequest(){if(this.newRequestDescription.trim()){this.submitting=!0;try{(await p.post("/api/help",{description:this.newRequestDescription})).data.success&&(window.showToast("ØªÙ… Ù†Ø´Ø± Ø·Ù„Ø¨ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©","success"),this.showNewRequestModal=!1,this.newRequestDescription="",this.activeTab="my")}catch{window.showToast("Ø­Ø¯Ø« Ø®Ø·Ø£","error")}finally{this.submitting=!1}}},async pickRequest(a){try{const t=await p.post(`/api/help/${a.id}/pick`);t.data.success?(window.showToast("Ø´ÙƒØ±Ø§Ù‹ Ù„Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ! ğŸ™","success"),this.showDetailsModal=!1,this.loadData()):window.showToast(t.data.message,"error")}catch(t){window.showToast(t.response?.data?.message||"Ø­Ø¯Ø« Ø®Ø·Ø£","error")}},async cancelRequest(a){try{const t=await p.post(`/api/help/${a.id}/cancel`);t.data.success?(window.showToast("ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø·Ù„Ø¨","success"),this.loadData()):window.showToast(t.data.message,"error")}catch(t){window.showToast(t.response?.data?.message||"Ø­Ø¯Ø« Ø®Ø·Ø£","error")}},async openDetails(a){try{const t=await p.get(`/api/help/${a.id}`);t.data.success&&(this.selectedRequest=t.data.request,this.showDetailsModal=!0)}catch{window.showToast("ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙØ§ØµÙŠÙ„","error")}},async addComment(){if(!(!this.newComment.trim()||this.addingComment)){this.addingComment=!0;try{const a=await p.post(`/api/help/${this.selectedRequest.id}/comment`,{comment:this.newComment});a.data.success&&(this.selectedRequest.comments.push(a.data.comment),this.newComment="")}catch(a){window.showToast(a.response?.data?.message||"Ø­Ø¯Ø« Ø®Ø·Ø£","error")}finally{this.addingComment=!1}}},formatDate(a){const t=new Date(a),c=Math.floor((new Date-t)/1e3);return c<60?"Ø§Ù„Ø¢Ù†":c<3600?`Ù…Ù†Ø° ${Math.floor(c/60)} Ø¯Ù‚ÙŠÙ‚Ø©`:c<86400?`Ù…Ù†Ø° ${Math.floor(c/3600)} Ø³Ø§Ø¹Ø©`:c<604800?`Ù…Ù†Ø° ${Math.floor(c/86400)} ÙŠÙˆÙ…`:t.toLocaleDateString("ar-EG")}}},S={class:"relative flex h-[100vh] w-full flex-col overflow-hidden max-w-md mx-auto bg-background-light dark:bg-background-dark font-display",dir:"rtl"},L={class:"sticky top-0 z-20 bg-background-light/95 dark:bg-background-dark/95 backdrop-blur-md border-b border-slate-100 dark:border-slate-800/10 transition-all duration-200",style:{"padding-top":"env(safe-area-inset-top)"}},V={class:"flex items-center justify-between px-4 py-3"},O={class:"overflow-x-auto no-scrollbar border-b border-slate-100 dark:border-slate-800/10 bg-white dark:bg-surface-dark"},B={class:"flex min-w-max px-4 py-2 gap-2"},E=["onClick"],F={class:"flex-1 overflow-y-auto overflow-x-hidden no-scrollbar pb-24"},G={class:"flex flex-col gap-3 p-4 min-h-[60vh]"},A={key:0,class:"text-center py-12 text-slate-400"},J={key:1,class:"flex-1 flex flex-col items-center justify-center text-center py-12 text-slate-400"},K={class:"material-symbols-outlined text-5xl"},Q={class:"mt-2"},W=["onClick"],X={class:"flex items-start justify-between gap-3 mb-3"},Y={class:"flex items-center gap-3"},Z={class:"font-bold text-slate-900 dark:text-white text-sm"},$={key:0,class:"text-xs text-slate-500"},ee={key:0},te={key:1},se={key:2},le={class:"text-xs text-slate-400"},ae={class:"text-sm text-slate-700 dark:text-slate-300 leading-relaxed line-clamp-3"},oe={key:0,class:"mt-3 flex items-center gap-2 bg-blue-50 dark:bg-blue-900/20 p-2 rounded-lg"},re={class:"text-xs font-medium text-blue-700 dark:text-blue-300"},ne={key:1,class:"mt-3"},ie=["onClick"],de={key:2,class:"mt-3"},ce=["onClick"],ue=["disabled"],pe={key:0,class:"material-symbols-outlined animate-spin text-[18px]"},me={class:"fixed bottom-0 left-0 right-0 bg-white/95 dark:bg-surface-dark/95 backdrop-blur-md border-t border-slate-200 dark:border-slate-800 pb-safe z-40"},he={class:"flex items-center justify-around h-16 max-w-md mx-auto"},be={class:"space-y-4"},xe=["disabled"],fe={key:0,class:"material-symbols-outlined animate-spin text-[18px]"},ge={key:0,class:"space-y-4"},ye={class:"flex items-center gap-3 pb-4 border-b border-slate-100 dark:border-slate-800"},we={class:"font-bold text-slate-900 dark:text-white"},_e={key:0,class:"text-sm text-slate-500"},ke={class:"bg-slate-50 dark:bg-slate-800/50 p-4 rounded-xl"},ve={class:"text-sm text-slate-700 dark:text-slate-300 leading-relaxed"},qe={key:0,class:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-xl"},Re={class:"flex items-center gap-3"},Ce={class:"font-bold text-slate-900 dark:text-white text-sm"},Te={key:0,class:"text-xs text-slate-500"},Me={key:1,class:"space-y-3"},De={class:"text-sm font-bold text-slate-900 dark:text-white"},Ue={class:"max-h-48 overflow-y-auto space-y-2"},Pe={class:"text-xs font-bold text-slate-900 dark:text-white"},ze={class:"text-sm text-slate-600 dark:text-slate-300"},He={key:0,class:"flex gap-2"},Ne=["disabled"],je={key:0,class:"material-symbols-outlined animate-spin text-[16px]"},Ie={key:1},Se={key:2,class:"pt-2"};function Le(a,t,R,c,l,i){const C=h("Head"),T=h("Toast"),M=h("PullToRefresh"),f=h("Link"),_=h("Modal");return r(),o(x,null,[u(C,{title:"Ù…Ø³Ø§Ø¹Ø¯Ø©"}),u(T),e("div",S,[e("header",L,[e("div",V,[t[10]||(t[10]=e("div",{class:"flex items-center gap-3"},[e("div",{class:"size-10 rounded-full bg-rose-100 dark:bg-rose-900/30 flex items-center justify-center text-rose-600 dark:text-rose-400"},[e("span",{class:"material-symbols-outlined"},"volunteer_activism")]),e("div",null,[e("span",{class:"text-lg font-bold text-slate-900 dark:text-white"},"Ù…Ø³Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¬ÙŠØ±Ø§Ù†")])],-1)),e("button",{onClick:t[0]||(t[0]=s=>l.showNewRequestModal=!0),class:"flex items-center gap-1 px-3 py-2 bg-primary text-white rounded-xl text-sm font-bold shadow-lg shadow-primary/20"},[...t[9]||(t[9]=[e("span",{class:"material-symbols-outlined text-[18px]"},"add",-1),e("span",null,"Ø·Ù„Ø¨ Ù…Ø³Ø§Ø¹Ø¯Ø©",-1)])])])]),e("div",O,[e("div",B,[(r(!0),o(x,null,y(l.tabs,s=>(r(),o("button",{key:s.id,onClick:g=>l.activeTab=s.id,class:w(["h-9 px-4 rounded-full text-sm font-semibold transition-colors whitespace-nowrap",l.activeTab===s.id?"bg-primary text-white":"bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-400"])},n(s.label),11,E))),128))])]),e("div",F,[u(M,{onRefresh:i.loadData,class:"min-h-full"},{default:m(()=>[e("div",G,[l.loading?(r(),o("div",A,[...t[11]||(t[11]=[e("span",{class:"material-symbols-outlined text-4xl animate-spin"},"progress_activity",-1)])])):l.requests.length===0?(r(),o("div",J,[e("span",K,n(i.emptyIcon),1),e("p",Q,n(i.emptyMessage),1)])):(r(!0),o(x,{key:2},y(l.requests,s=>(r(),o("div",{key:s.id,onClick:g=>i.openDetails(s),class:"bg-white dark:bg-surface-dark p-4 rounded-2xl shadow-sm border border-slate-100 dark:border-slate-700 cursor-pointer active:bg-slate-50 dark:active:bg-slate-800 transition-colors"},[e("div",X,[e("div",Y,[e("div",{class:"size-10 rounded-full bg-cover bg-center bg-slate-100",style:b(`background-image: url('${s.requester?.photo||"https://ui-avatars.com/api/?name="+(s.requester?.name||"U")}');`)},null,4),e("div",null,[e("p",Z,n(s.requester?.name),1),l.activeTab==="available"&&s.requester?(r(),o("p",$,[s.requester.block_no?(r(),o("span",ee,"Ø¹Ù…Ø§Ø±Ø© "+n(s.requester.block_no),1)):d("",!0),s.requester.floor?(r(),o("span",te," - Ø§Ù„Ø¯ÙˆØ± "+n(s.requester.floor),1)):d("",!0),s.requester.apt_no?(r(),o("span",se," - Ø´Ù‚Ø© "+n(s.requester.apt_no),1)):d("",!0)])):d("",!0),e("p",le,n(i.formatDate(s.created_at)),1)])]),e("span",{class:w(["px-2 py-1 rounded-full text-[10px] font-bold",{"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":s.status==="open","bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400":s.status==="picked","bg-slate-100 text-slate-500 dark:bg-slate-800 dark:text-slate-400":s.status==="cancelled"}])},n(s.status==="open"?"Ù…ÙØªÙˆØ­":s.status==="picked"?"ØªÙ… Ø§Ù„Ø§Ù„ØªÙ‚Ø§Ø·":"Ù…Ù„ØºÙŠ"),3)]),e("p",ae,n(s.description),1),s.helper&&(l.activeTab==="my"||l.activeTab==="helped")?(r(),o("div",oe,[e("div",{class:"size-6 rounded-full bg-cover bg-center",style:b(`background-image: url('${s.helper?.photo||"https://ui-avatars.com/api/?name="+(s.helper?.name||"H")}');`)},null,4),e("span",re,n(l.activeTab==="my"?"ÙŠØ³Ø§Ø¹Ø¯Ùƒ: ":"ØªØ³Ø§Ø¹Ø¯: ")+n(l.activeTab==="my"?s.helper?.name:s.requester?.name),1)])):d("",!0),l.activeTab==="available"?(r(),o("div",ne,[e("button",{onClick:k(g=>i.pickRequest(s),["stop"]),class:"w-full py-2 bg-primary text-white rounded-lg text-sm font-bold shadow-sm"}," Ø³Ø£Ø³Ø§Ø¹Ø¯ ğŸ™‹ ",8,ie)])):d("",!0),l.activeTab==="my"&&s.status==="open"?(r(),o("div",de,[e("button",{onClick:k(g=>i.cancelRequest(s),["stop"]),class:"w-full py-2 bg-red-500 text-white rounded-lg text-sm font-bold"}," Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø·Ù„Ø¨ ",8,ce)])):d("",!0)],8,W))),128)),l.nextPageUrl&&!l.loading?(r(),o("button",{key:3,onClick:t[1]||(t[1]=(...s)=>i.loadMore&&i.loadMore(...s)),disabled:l.loadingMore,class:"w-full py-3 text-sm font-bold text-primary bg-primary/10 rounded-xl flex items-center justify-center gap-2"},[l.loadingMore?(r(),o("span",pe,"progress_activity")):d("",!0),e("span",null,n(l.loadingMore?"Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...":"ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø²ÙŠØ¯"),1)],8,ue)):d("",!0)])]),_:1},8,["onRefresh"])]),e("nav",me,[e("div",he,[u(f,{href:"/dashboard",class:"flex flex-col items-center justify-center flex-1 h-full gap-1 text-slate-400 dark:text-slate-500 hover:text-slate-600 dark:hover:text-slate-300 transition-colors"},{default:m(()=>[...t[12]||(t[12]=[e("span",{class:"material-symbols-outlined"},"home",-1),e("span",{class:"text-[10px] font-medium"},"Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©",-1)])]),_:1}),u(f,{href:"/help",class:"flex flex-col items-center justify-center flex-1 h-full gap-1 text-primary"},{default:m(()=>[...t[13]||(t[13]=[e("span",{class:"material-symbols-outlined fill-1"},"volunteer_activism",-1),e("span",{class:"text-[10px] font-bold"},"Ù…Ø³Ø§Ø¹Ø¯Ø©",-1)])]),_:1}),u(f,{href:"/settings",class:"flex flex-col items-center justify-center flex-1 h-full gap-1 text-slate-400 dark:text-slate-500 hover:text-slate-600 dark:hover:text-slate-300 transition-colors"},{default:m(()=>[...t[14]||(t[14]=[e("span",{class:"material-symbols-outlined"},"person",-1),e("span",{class:"text-[10px] font-medium"},"Ø§Ù„Ø­Ø³Ø§Ø¨",-1)])]),_:1})])]),u(_,{show:l.showNewRequestModal,title:"Ø·Ù„Ø¨ Ù…Ø³Ø§Ø¹Ø¯Ø©",onClose:t[4]||(t[4]=s=>l.showNewRequestModal=!1)},{default:m(()=>[e("div",be,[e("div",null,[t[15]||(t[15]=e("label",{class:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2"},"ÙˆØµÙ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©",-1)),v(e("textarea",{"onUpdate:modelValue":t[2]||(t[2]=s=>l.newRequestDescription=s),class:"w-full rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800/50 p-4 text-base text-slate-900 dark:text-white placeholder-slate-400 focus:border-primary focus:outline-none focus:ring-1 focus:ring-primary resize-none transition-colors",placeholder:"Ù…Ø«Ø§Ù„: Ù…Ø­ØªØ§Ø¬ Ø­Ø¯ ÙŠØ³Ø§Ø¹Ø¯Ù†ÙŠ Ø£Ù†Ù‚Ù„ Ø£Ø«Ø§Ø« Ø«Ù‚ÙŠÙ„...",rows:"4"},null,512),[[q,l.newRequestDescription]])]),e("button",{onClick:t[3]||(t[3]=(...s)=>i.submitNewRequest&&i.submitNewRequest(...s)),disabled:l.submitting||!l.newRequestDescription.trim(),class:"w-full py-4 bg-primary text-white font-bold rounded-xl shadow-lg shadow-primary/25 flex items-center justify-center gap-2 disabled:opacity-50"},[l.submitting?(r(),o("span",fe,"progress_activity")):d("",!0),t[16]||(t[16]=e("span",null,"Ù†Ø´Ø± Ø·Ù„Ø¨ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©",-1))],8,xe)])]),_:1},8,["show"]),u(_,{show:l.showDetailsModal,title:"ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨",onClose:t[8]||(t[8]=s=>l.showDetailsModal=!1)},{default:m(()=>[l.selectedRequest?(r(),o("div",ge,[e("div",ye,[e("div",{class:"size-12 rounded-full bg-cover bg-center",style:b(`background-image: url('${l.selectedRequest.requester?.photo||"https://ui-avatars.com/api/?name="+(l.selectedRequest.requester?.name||"U")}');`)},null,4),e("div",null,[e("p",we,n(l.selectedRequest.requester?.name),1),i.canSeePhone?(r(),o("p",_e,n(l.selectedRequest.requester?.phone),1)):d("",!0)])]),e("div",ke,[e("p",ve,n(l.selectedRequest.description),1)]),l.selectedRequest.helper?(r(),o("div",qe,[t[17]||(t[17]=e("p",{class:"text-xs font-bold text-blue-600 dark:text-blue-400 mb-2"},"Ø§Ù„Ù…ØªØ·ÙˆØ¹ Ù„Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©",-1)),e("div",Re,[e("div",{class:"size-10 rounded-full bg-cover bg-center",style:b(`background-image: url('${l.selectedRequest.helper?.photo||"https://ui-avatars.com/api/?name="+(l.selectedRequest.helper?.name||"H")}');`)},null,4),e("div",null,[e("p",Ce,n(l.selectedRequest.helper?.name),1),i.canSeeHelperPhone?(r(),o("p",Te,n(l.selectedRequest.helper?.phone),1)):d("",!0)])])])):d("",!0),l.selectedRequest.status==="picked"&&i.canComment?(r(),o("div",Me,[e("p",De,"Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª ("+n(l.selectedRequest.comments?.length||0)+"/50)",1),e("div",Ue,[(r(!0),o(x,null,y(l.selectedRequest.comments,s=>(r(),o("div",{key:s.id,class:w(["flex gap-2 p-2 rounded-lg",s.user_id===i.currentUserId?"bg-primary/10":"bg-slate-50 dark:bg-slate-800"])},[e("div",{class:"size-8 rounded-full bg-cover bg-center shrink-0",style:b(`background-image: url('${s.user?.photo||"https://ui-avatars.com/api/?name="+(s.user?.name||"U")}');`)},null,4),e("div",null,[e("p",Pe,n(s.user?.name),1),e("p",ze,n(s.comment),1)])],2))),128))]),(l.selectedRequest.comments?.length||0)<50?(r(),o("div",He,[v(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>l.newComment=s),type:"text",class:"flex-1 rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800/50 px-4 py-2 text-sm focus:border-primary focus:outline-none focus:ring-1 focus:ring-primary",placeholder:"Ø§ÙƒØªØ¨ ØªØ¹Ù„ÙŠÙ‚Ø§Ù‹..."},null,512),[[q,l.newComment]]),e("button",{onClick:t[6]||(t[6]=(...s)=>i.addComment&&i.addComment(...s)),disabled:!l.newComment.trim()||l.addingComment,class:"px-4 py-2 bg-primary text-white rounded-xl text-sm font-bold disabled:opacity-50"},[l.addingComment?(r(),o("span",je,"progress_activity")):(r(),o("span",Ie,"Ø¥Ø±Ø³Ø§Ù„"))],8,Ne)])):d("",!0)])):d("",!0),l.selectedRequest.status==="open"&&l.selectedRequest.requester_id!==i.currentUserId?(r(),o("div",Se,[e("button",{onClick:t[7]||(t[7]=s=>i.pickRequest(l.selectedRequest)),class:"w-full py-3 bg-primary text-white font-bold rounded-xl"}," Ø³Ø£Ø³Ø§Ø¹Ø¯ ğŸ™‹ ")])):d("",!0)])):d("",!0)]),_:1},8,["show"])])],64)}const Ge=j(I,[["render",Le]]);export{Ge as default};
