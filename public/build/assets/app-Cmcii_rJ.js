const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dashboard-CkKSSlTH.js","assets/vendor-C-E02GEk.js","assets/Modal-DUnvAo_q.js","assets/Modal-DA7eKiM2.css","assets/Dashboard-CdXyEzhZ.css","assets/app-NGTrc6dN.css","assets/Login-DnU5AZKz.js","assets/Login-DVkUkv3A.css","assets/Dashboard-Ci7-dQtU.js","assets/PullToRefresh-C4H_gFx7.js","assets/PullToRefresh-DC0jKjah.css","assets/firebase-C1pvGlTP.js","assets/Dashboard-Fzw0ZDKB.css","assets/Dashboard-DGU_wOgQ.js","assets/Dashboard-ox5YaMwk.css","assets/Help-3iG--Hc5.js","assets/Settings-BMiPD5bH.js","assets/Settings-tn0RQdqM.css"])))=>i.map(i=>d[i]);
import{a as A,c as p,b as x,d as t,e as k,o as c,f as C,w as g,t as b,g as L,T as y,r as I,u as T,h as E,F as M,i as R,j as q,k as v}from"./vendor-C-E02GEk.js";/* empty css            */const N="modulepreload",j=function(s){return"/build/"+s},P={},h=function(e,a,r){let n=Promise.resolve();if(a&&a.length>0){let u=function(d){return Promise.all(d.map(m=>Promise.resolve(m).then(w=>({status:"fulfilled",value:w}),w=>({status:"rejected",reason:w}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=o?.nonce||o?.getAttribute("nonce");n=u(a.map(d=>{if(d=j(d),d in P)return;P[d]=!0;const m=d.endsWith(".css"),w=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${w}`))return;const f=document.createElement("link");if(f.rel=m?"stylesheet":N,m||(f.as="script"),f.crossOrigin="",f.href=d,l&&f.setAttribute("nonce",l),document.head.appendChild(f),m)return new Promise((O,S)=>{f.addEventListener("load",O),f.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${d}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return n.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return e().catch(i)})};window.axios=A;window.axios.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";async function D(s,e){for(const a of Array.isArray(s)?s:[s]){const r=e[a];if(!(typeof r>"u"))return typeof r=="function"?r():r}throw new Error(`Page not found: ${s}`)}const _=(s,e)=>{const a=s.__vccOpts||s;for(const[r,n]of e)a[r]=n;return a},B={data(){return{deferredPrompt:null,showOverlay:!1,isIOS:!1}},mounted(){this.isIOS=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone||(window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),this.deferredPrompt=e,this.showOverlay=!0}),this.isIOS&&(this.showOverlay=!0))},methods:{async installApp(){if(!this.deferredPrompt){this.isIOS&&window.showToast("اتبع تعليمات الإضافة في الأسفل","info");return}this.deferredPrompt.prompt();const{outcome:s}=await this.deferredPrompt.userChoice;s==="accepted"&&(console.log("User accepted the install prompt"),this.showOverlay=!1),this.deferredPrompt=null}}},U={key:0,class:"fixed inset-0 z-[100] flex items-center justify-center bg-slate-900/90 backdrop-blur-md p-6 overflow-hidden"},V={class:"relative w-full max-w-sm bg-white dark:bg-slate-800 rounded-3xl p-8 flex flex-col items-center text-center shadow-2xl animate-in fade-in zoom-in duration-300"},z={key:1,class:"mt-4 p-4 bg-slate-50 dark:bg-slate-700/50 rounded-xl border border-dashed border-slate-200 dark:border-slate-600"};function W(s,e,a,r,n,i){return n.showOverlay?(c(),p("div",U,[t("div",V,[e[4]||(e[4]=t("div",{class:"w-24 h-24 bg-primary/10 rounded-2xl flex items-center justify-center mb-6 shadow-inner tracking-tighter"},[t("img",{src:"/icons/icon-192x192.png",class:"w-16 h-16 object-contain",alt:"App Logo"})],-1)),e[5]||(e[5]=t("h2",{class:"text-2xl font-bold text-slate-900 dark:text-white mb-2"},"ثبّت التطبيق الآن",-1)),e[6]||(e[6]=t("p",{class:"text-slate-500 dark:text-slate-400 mb-8 leading-relaxed"}," للحصول على أفضل تجربة وأسرع وصول لخدمات المجمع، يرجى إضافة التطبيق إلى شاشتك الرئيسية. ",-1)),t("button",{onClick:e[0]||(e[0]=(...o)=>i.installApp&&i.installApp(...o)),class:"w-full bg-primary text-white font-bold py-4 rounded-xl shadow-lg shadow-primary/30 hover:bg-blue-600 active:scale-95 transition-all mb-4 flex items-center justify-center gap-2"},[...e[2]||(e[2]=[t("span",{class:"material-symbols-outlined"},"download",-1),t("span",null,"تثبيت الآن",-1)])]),n.isIOS?x("",!0):(c(),p("button",{key:0,onClick:e[1]||(e[1]=o=>n.showOverlay=!1),class:"text-slate-400 dark:text-slate-500 text-sm font-medium hover:text-slate-600 dark:hover:text-slate-400 transition-colors"}," سأقوم بذلك لاحقاً ")),n.isIOS?(c(),p("div",z,[...e[3]||(e[3]=[t("p",{class:"text-xs text-slate-600 dark:text-slate-300 flex flex-col items-center gap-2"},[t("span",null,[k("لأجهزة iOS، اضغط على زر "),t("span",{class:"material-symbols-outlined text-[18px] align-middle"},"ios_share"),k(' ثم "إضافة للشاشة الرئيسية"')])],-1)])])):x("",!0)])])):x("",!0)}const $=_(B,[["render",W]]),H={name:"InAppNotification",data(){return{notification:null,timeout:null,audio:null,audioUnlocked:!1}},computed:{title(){return this.notification?.data?.title||"إشعار جديد"},body(){return this.notification?.data?.body||""},icon(){const s=this.notification?.data?.type;return{NEW_REQUEST:"potted_plant",NEW_PROPOSAL:"local_offer",PROPOSAL_ACCEPTED:"check_circle",WORK_COMPLETED:"verified",NEW_REVIEW:"star",new_help_request:"volunteer_activism",help_picked:"emoji_people",help_comment:"chat"}[s]||"notifications"}},mounted(){window.addEventListener("fcm-message",this.handleMessage);const s=()=>{this.initAudio(),window.removeEventListener("click",s),window.removeEventListener("touchstart",s)};window.addEventListener("click",s),window.addEventListener("touchstart",s)},beforeUnmount(){window.removeEventListener("fcm-message",this.handleMessage)},methods:{initAudio(){this.audioUnlocked||(this.audio=new Audio("/sounds/notification.wav"),this.audio.volume=0,this.audio.play().then(()=>{this.audio.pause(),this.audio.currentTime=0,this.audio.volume=.5,this.audioUnlocked=!0,console.log("Audio unlocked for iOS")}).catch(s=>{console.warn("Audio unlock failed:",s)}))},handleMessage(s){const e=s.detail,a=T().props.auth?.user?.id;if(!(e?.data?.sender_id&&a&&e.data.sender_id==a))if(this.notification=e,this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.notification=null},6e3),this.audio&&this.audioUnlocked)this.audio.currentTime=0,this.audio.play().catch(r=>console.warn("Sound play failed:",r));else{const r=new Audio("/sounds/notification.wav");r.volume=.5,r.play().catch(()=>{})}},handleClick(){const s=this.notification?.data,e=s?.help_request_id||s?.request_id;e&&(s.type==="new_help_request"||s.type==="help_picked"||s.type==="help_comment"?window.location.pathname==="/help"?window.dispatchEvent(new CustomEvent("open-help-details",{detail:{requestId:e}})):I.visit(`/help?request_id=${e}`):window.dispatchEvent(new CustomEvent("open-request-details",{detail:{requestId:parseInt(e)}}))),this.notification=null}}},F={class:"size-12 rounded-full bg-primary/10 flex items-center justify-center flex-shrink-0"},K={class:"material-symbols-outlined text-primary text-2xl"},X={class:"flex-1 min-w-0"},Q={class:"text-sm font-bold text-slate-900 dark:text-white truncate"},G={class:"text-xs text-slate-500 dark:text-slate-400 mt-1 line-clamp-2"};function J(s,e,a,r,n,i){return c(),C(y,{name:"notif"},{default:g(()=>[n.notification?(c(),p("div",{key:0,onClick:e[1]||(e[1]=(...o)=>i.handleClick&&i.handleClick(...o)),class:"fixed left-4 right-4 z-[110] bg-white dark:bg-slate-800 shadow-2xl rounded-2xl p-4 border border-slate-100 dark:border-slate-700 flex items-start gap-4 cursor-pointer active:scale-95 transition-transform max-w-md mx-auto pointer-events-auto",style:{top:"max(1rem, calc(env(safe-area-inset-top) + 0.5rem))"},dir:"rtl"},[t("div",F,[t("span",K,b(i.icon),1)]),t("div",X,[t("h4",Q,b(i.title),1),t("p",G,b(i.body),1),e[2]||(e[2]=t("div",{class:"mt-2 flex items-center text-[10px] font-bold text-primary uppercase tracking-wider"},[t("span",null,"اضغط للتفاصيل"),t("span",{class:"material-symbols-outlined text-[14px] mr-1"},"chevron_left")],-1))]),t("button",{onClick:e[0]||(e[0]=L(o=>n.notification=null,["stop"])),class:"text-slate-400 hover:text-slate-600 dark:hover:text-slate-200"},[...e[3]||(e[3]=[t("span",{class:"material-symbols-outlined text-[18px]"},"close",-1)])])])):x("",!0)]),_:1})}const Y=_(H,[["render",J],["__scopeId","data-v-0aec6f29"]]),Z={name:"OpenInAppBanner",data(){return{showBanner:!1,showModal:!1,isStandalone:!1,isIOS:!1}},mounted(){this.isIOS=/iPad|iPhone|iPod/.test(navigator.userAgent),this.checkContext()},methods:{checkContext(){this.isStandalone=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0||document.referrer.includes("android-app://"),this.isStandalone||sessionStorage.getItem("app_banner_dismissed")||setTimeout(()=>{this.showBanner=!0},2e3)},showInstructions(){this.showModal=!0},closeModal(){this.showModal=!1,this.dismiss()},dismiss(){this.showBanner=!1,sessionStorage.setItem("app_banner_dismissed","true")}}},ee={key:0,class:"fixed top-0 left-0 right-0 z-[9999] bg-gradient-to-r from-primary to-blue-600 text-white px-4 py-3 shadow-lg font-display",dir:"rtl",style:{"padding-top":"max(env(safe-area-inset-top), 12px)"}},te={class:"max-w-md mx-auto flex items-center justify-between gap-3"},se={class:"flex items-center gap-2"},oe={key:0,class:"fixed inset-0 z-[10000] flex items-center justify-center p-4 font-display",dir:"rtl"},ne={class:"relative bg-white dark:bg-slate-800 rounded-2xl p-6 max-w-sm w-full shadow-2xl"},ie={class:"space-y-4 text-sm text-slate-600 dark:text-slate-300"},ae={key:0,class:"space-y-3"},re={key:1,class:"space-y-3"};function le(s,e,a,r,n,i){return c(),p(M,null,[E(y,{name:"slide-down"},{default:g(()=>[n.showBanner?(c(),p("div",ee,[t("div",te,[e[6]||(e[6]=t("div",{class:"flex items-center gap-3"},[t("div",{class:"size-10 rounded-xl bg-white/20 flex items-center justify-center"},[t("span",{class:"material-symbols-outlined text-[24px]"},"phone_iphone")]),t("div",null,[t("p",{class:"text-sm font-bold"},"افتح التطبيق"),t("p",{class:"text-xs opacity-80"},"تجربة أفضل وأسرع")])],-1)),t("div",se,[t("button",{onClick:e[0]||(e[0]=(...o)=>i.showInstructions&&i.showInstructions(...o)),class:"bg-white text-primary px-4 py-2 rounded-lg text-sm font-bold shadow-sm active:scale-95 transition-transform"}," فتح "),t("button",{onClick:e[1]||(e[1]=(...o)=>i.dismiss&&i.dismiss(...o)),class:"p-2 hover:bg-white/10 rounded-full transition-colors"},[...e[5]||(e[5]=[t("span",{class:"material-symbols-outlined text-[20px]"},"close",-1)])])])])])):x("",!0)]),_:1}),E(y,{name:"fade"},{default:g(()=>[n.showModal?(c(),p("div",oe,[t("div",{class:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:e[2]||(e[2]=(...o)=>i.closeModal&&i.closeModal(...o))}),t("div",ne,[t("button",{onClick:e[3]||(e[3]=(...o)=>i.closeModal&&i.closeModal(...o)),class:"absolute top-4 left-4 text-slate-400 hover:text-slate-600"},[...e[7]||(e[7]=[t("span",{class:"material-symbols-outlined"},"close",-1)])]),e[10]||(e[10]=t("div",{class:"text-center mb-6"},[t("div",{class:"size-16 rounded-2xl bg-primary/10 flex items-center justify-center mx-auto mb-4"},[t("span",{class:"material-symbols-outlined text-primary text-[32px]"},"phone_iphone")]),t("h3",{class:"text-lg font-bold text-slate-900 dark:text-white"},"افتح من التطبيق")],-1)),t("div",ie,[n.isIOS?(c(),p("div",ae,[...e[8]||(e[8]=[t("p",{class:"font-bold text-slate-900 dark:text-white"},"إذا كان التطبيق مثبتاً:",-1),t("div",{class:"flex items-start gap-3 bg-slate-50 dark:bg-slate-700/50 p-3 rounded-xl"},[t("span",{class:"material-symbols-outlined text-primary"},"touch_app"),t("span",null,"اضغط على أيقونة التطبيق من الشاشة الرئيسية")],-1),t("p",{class:"font-bold text-slate-900 dark:text-white pt-2"},"إذا لم يكن مثبتاً:",-1),t("div",{class:"flex items-start gap-3 bg-slate-50 dark:bg-slate-700/50 p-3 rounded-xl"},[t("span",{class:"material-symbols-outlined text-primary"},"ios_share"),t("span",null,'اضغط على زر المشاركة ⬆️ ثم "إضافة إلى الشاشة الرئيسية"')],-1)])])):(c(),p("div",re,[...e[9]||(e[9]=[t("p",{class:"font-bold text-slate-900 dark:text-white"},"إذا كان التطبيق مثبتاً:",-1),t("div",{class:"flex items-start gap-3 bg-slate-50 dark:bg-slate-700/50 p-3 rounded-xl"},[t("span",{class:"material-symbols-outlined text-primary"},"touch_app"),t("span",null,"اضغط على أيقونة التطبيق من الشاشة الرئيسية")],-1),t("p",{class:"font-bold text-slate-900 dark:text-white pt-2"},"إذا لم يكن مثبتاً:",-1),t("div",{class:"flex items-start gap-3 bg-slate-50 dark:bg-slate-700/50 p-3 rounded-xl"},[t("span",{class:"material-symbols-outlined text-primary"},"more_vert"),t("span",null,'اضغط على قائمة المتصفح ⋮ ثم "تثبيت التطبيق" أو "إضافة إلى الشاشة الرئيسية"')],-1)])]))]),t("button",{onClick:e[4]||(e[4]=(...o)=>i.closeModal&&i.closeModal(...o)),class:"w-full mt-6 py-3 bg-primary text-white font-bold rounded-xl active:scale-[0.98] transition-transform"}," حسناً، فهمت ")])])):x("",!0)]),_:1})],64)}const de=_(Z,[["render",le],["__scopeId","data-v-66573ec6"]]);R({title:s=>`${s} - خدمات المجمع`,resolve:s=>D(`./Pages/${s}.vue`,Object.assign({"./Pages/Admin/Dashboard.vue":()=>h(()=>import("./Dashboard-CkKSSlTH.js"),__vite__mapDeps([0,1,2,3,4,5])),"./Pages/Auth/Login.vue":()=>h(()=>import("./Login-DnU5AZKz.js"),__vite__mapDeps([6,1,7,5])),"./Pages/Provider/Dashboard.vue":()=>h(()=>import("./Dashboard-Ci7-dQtU.js"),__vite__mapDeps([8,1,2,3,9,10,11,5,12])),"./Pages/Resident/Dashboard.vue":()=>h(()=>import("./Dashboard-DGU_wOgQ.js"),__vite__mapDeps([13,1,2,3,9,10,11,5,14])),"./Pages/Resident/Help.vue":()=>h(()=>import("./Help-3iG--Hc5.js"),__vite__mapDeps([15,1,2,3,9,10,5])),"./Pages/Settings.vue":()=>h(()=>import("./Settings-BMiPD5bH.js"),__vite__mapDeps([16,1,2,3,17,5]))})),setup({el:s,App:e,props:a,plugin:r}){const n=q({render:()=>v("div",[v(de),v(e,a),v($),v(Y)])});return n.use(r),n.mount(s),n},progress:{delay:0,color:"#10b981",includeCSS:!0,showSpinner:!1}});if("BroadcastChannel"in window){const s=new BroadcastChannel("notification_channel");s.onmessage=e=>{const a=e.data;if(!a||a.type!=="ON_NOTIFICATION_CLICK")return;const r=a.url||"/dashboard",n=new URL(r,window.location.origin),i=n.searchParams.get("request_id"),o=u=>{I.visit(u)},l=u=>{window.dispatchEvent(new CustomEvent("open-request-details",{detail:{requestId:u}}))};if(i){if(n.pathname.includes("/help")){o(r);return}const u=window.location.pathname;["/resident","/provider","/dashboard"].some(m=>u.includes(m))?l(Number(i)):o(r)}else{const u=n.pathname+n.search;o(u)}},window.addEventListener("beforeunload",()=>{s.close()})}export{_,h as a};
