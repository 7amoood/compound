import{_ as l}from"./app-BnuCnCFH.js";import{c,o as h,d as i,p as u,n as o,t as d,G as p}from"./vendor-tvXOKrQx.js";const f={name:"PullToRefresh",props:{threshold:{type:Number,default:60},onRefresh:{type:Function,required:!0}},data(){return{startY:0,currentY:0,pullDelta:0,isLoading:!1,isDragging:!1,canPull:!1}},computed:{indicatorStyle(){const t=Math.min(this.pullDelta/this.threshold,1);return{height:`${this.pullDelta}px`,opacity:t,transition:this.isDragging?"none":"height 0.4s cubic-bezier(0.19, 1, 0.22, 1), opacity 0.3s ease"}},contentStyle(){const s=1-Math.min(this.pullDelta/this.threshold,1)*(1-.25);return{transform:`translateY(${this.pullDelta}px)`,opacity:s,transition:this.isDragging?"none":"transform 0.4s cubic-bezier(0.19, 1, 0.22, 1), opacity 0.4s ease"}},iconRotateStyle(){return this.isLoading?{}:{transform:`rotate(${this.pullDelta>this.threshold?180:0}deg)`,transition:"transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1)"}}},mounted(){this.$refs.container.addEventListener("touchstart",this.onTouchStart,{passive:!0}),this.$refs.container.addEventListener("touchmove",this.onTouchMove,{passive:!1}),this.$refs.container.addEventListener("touchend",this.onTouchEnd,{passive:!0})},beforeUnmount(){this.$refs.container&&(this.$refs.container.removeEventListener("touchstart",this.onTouchStart),this.$refs.container.removeEventListener("touchmove",this.onTouchMove),this.$refs.container.removeEventListener("touchend",this.onTouchEnd))},methods:{onTouchStart(t){if(this.isLoading)return;const e=this.getScrollParent(this.$refs.container);let s=0;e?s=e.scrollTop:s=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop,s<=0?(this.canPull=!0,this.startY=t.touches[0].clientY):this.canPull=!1},onTouchMove(t){if(!this.canPull||this.isLoading)return;const s=t.touches[0].clientY-this.startY;s>0?(this.isDragging=!0,this.pullDelta=Math.pow(s,.85),t.cancelable&&t.preventDefault()):(this.pullDelta=0,this.isDragging=!1)},async onTouchEnd(){if(!this.canPull||this.isLoading)return;const t=this.pullDelta>=this.threshold;if(this.isDragging=!1,this.canPull=!1,t){this.isLoading=!0,this.pullDelta=50;try{await this.onRefresh()}finally{this.isLoading=!1,this.pullDelta=0}}else this.pullDelta=0},getScrollParent(t){let e=t.parentElement;for(;e;){const n=window.getComputedStyle(e).getPropertyValue("overflow-y");if((n==="auto"||n==="scroll")&&e.scrollHeight>e.clientHeight)return e;e=e.parentElement}return null}}},g={ref:"container",class:"pull-to-refresh-wrapper"};function m(t,e,s,n,a,r){return h(),c("div",g,[i("div",{class:"ptr-indicator",style:o(r.indicatorStyle)},[i("div",{class:u(["ptr-icon-box",{"ptr-loading":a.isLoading}])},[i("span",{class:"material-symbols-outlined font-bold",style:o(r.iconRotateStyle)},d(a.isLoading?"progress_activity":"arrow_downward"),5)],2)],4),i("div",{style:o(r.contentStyle),class:"ptr-content"},[p(t.$slots,"default",{},void 0)],4)],512)}const D=l(f,[["render",m],["__scopeId","data-v-81d08d5c"]]);export{D as P};
