import{E as D,l as U,m as h,c as o,o as r,h as u,d as e,F as x,s as w,w as m,b as d,t as i,n as b,p as y,g as _,q as v,v as q,a as p,z as P}from"./vendor-tvXOKrQx.js";import{T as z,M as H}from"./Modal-BYOXSp9T.js";import{P as N}from"./PullToRefresh-CwJa1q-G.js";import{_ as I}from"./app-VXi0l-qX.js";/* empty css            */const j={name:"Help",components:{Head:U,Link:D,Modal:H,Toast:z,PullToRefresh:N},data(){return{activeTab:"available",tabs:[{id:"available",label:"Ø·Ù„Ø¨Ø§Øª Ù…ØªØ§Ø­Ø©"},{id:"my",label:"Ø·Ù„Ø¨Ø§ØªÙŠ"},{id:"helped",label:"Ø³Ø§Ø¹Ø¯Øª ÙÙŠÙ‡Ø§"},{id:"cancelled",label:"Ù…Ù„ØºÙŠØ©"}],requests:[],loading:!1,loadingMore:!1,nextPageUrl:null,showNewRequestModal:!1,showDetailsModal:!1,selectedRequest:null,newRequestDescription:"",submitting:!1,newComment:"",addingComment:!1}},computed:{currentUserId(){return P().props.auth?.user?.id},emptyIcon(){return{available:"volunteer_activism",my:"inbox",helped:"handshake",cancelled:"delete_sweep"}[this.activeTab]||"inbox"},emptyMessage(){return{available:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ù…Ø³Ø§Ø¹Ø¯Ø© Ø­Ø§Ù„ÙŠØ§Ù‹",my:"Ù„Ù… ØªØ·Ù„Ø¨ Ù…Ø³Ø§Ø¹Ø¯Ø© Ø¨Ø¹Ø¯",helped:"Ù„Ù… ØªØ³Ø§Ø¹Ø¯ Ø£Ø­Ø¯Ø§Ù‹ Ø¨Ø¹Ø¯",cancelled:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ù…Ù„ØºÙŠØ©"}[this.activeTab]||"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª"},canSeePhone(){if(!this.selectedRequest)return!1;const a=this.selectedRequest.requester_id===this.currentUserId,t=this.selectedRequest.helper_id===this.currentUserId;return a||t},canSeeHelperPhone(){return this.selectedRequest?this.selectedRequest.requester_id===this.currentUserId:!1},canComment(){if(!this.selectedRequest)return!1;const a=this.selectedRequest.requester_id===this.currentUserId,t=this.selectedRequest.helper_id===this.currentUserId;return a||t}},watch:{activeTab(){this.loadData()}},mounted(){this.loadData()},methods:{async loadData(){this.loading=!0,this.requests=[],this.nextPageUrl=null;try{let a="/api/help/available";this.activeTab==="my"?a="/api/help/my-requests":this.activeTab==="helped"?a="/api/help/my-helps":this.activeTab==="cancelled"&&(a="/api/help/my-requests?status=cancelled");const t=await p.get(a);t.data.success&&(this.requests=t.data.requests.data,this.nextPageUrl=t.data.requests.next_page_url)}catch(a){console.error(a)}finally{this.loading=!1}},async loadMore(){if(!(!this.nextPageUrl||this.loadingMore)){this.loadingMore=!0;try{const a=await p.get(this.nextPageUrl);a.data.success&&(this.requests.push(...a.data.requests.data),this.nextPageUrl=a.data.requests.next_page_url)}catch(a){console.error(a)}finally{this.loadingMore=!1}}},async submitNewRequest(){if(this.newRequestDescription.trim()){this.submitting=!0;try{(await p.post("/api/help",{description:this.newRequestDescription})).data.success&&(window.showToast("ØªÙ… Ù†Ø´Ø± Ø·Ù„Ø¨ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©","success"),this.showNewRequestModal=!1,this.newRequestDescription="",this.activeTab="my")}catch{window.showToast("Ø­Ø¯Ø« Ø®Ø·Ø£","error")}finally{this.submitting=!1}}},async pickRequest(a){try{const t=await p.post(`/api/help/${a.id}/pick`);t.data.success?(window.showToast("Ø´ÙƒØ±Ø§Ù‹ Ù„Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ! ğŸ™","success"),this.showDetailsModal=!1,this.loadData()):window.showToast(t.data.message,"error")}catch(t){window.showToast(t.response?.data?.message||"Ø­Ø¯Ø« Ø®Ø·Ø£","error")}},async cancelRequest(a){try{const t=await p.post(`/api/help/${a.id}/cancel`);t.data.success?(window.showToast("ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø·Ù„Ø¨","success"),this.loadData()):window.showToast(t.data.message,"error")}catch(t){window.showToast(t.response?.data?.message||"Ø­Ø¯Ø« Ø®Ø·Ø£","error")}},async openDetails(a){try{const t=await p.get(`/api/help/${a.id}`);t.data.success&&(this.selectedRequest=t.data.request,this.showDetailsModal=!0)}catch{window.showToast("ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙØ§ØµÙŠÙ„","error")}},async addComment(){if(!(!this.newComment.trim()||this.addingComment)){this.addingComment=!0;try{const a=await p.post(`/api/help/${this.selectedRequest.id}/comment`,{comment:this.newComment});a.data.success&&(this.selectedRequest.comments.push(a.data.comment),this.newComment="")}catch(a){window.showToast(a.response?.data?.message||"Ø­Ø¯Ø« Ø®Ø·Ø£","error")}finally{this.addingComment=!1}}},formatDate(a){const t=new Date(a),c=Math.floor((new Date-t)/1e3);return c<60?"Ø§Ù„Ø¢Ù†":c<3600?`Ù…Ù†Ø° ${Math.floor(c/60)} Ø¯Ù‚ÙŠÙ‚Ø©`:c<86400?`Ù…Ù†Ø° ${Math.floor(c/3600)} Ø³Ø§Ø¹Ø©`:c<604800?`Ù…Ù†Ø° ${Math.floor(c/86400)} ÙŠÙˆÙ…`:t.toLocaleDateString("ar-EG")}}},S={class:"relative flex h-[100vh] w-full flex-col overflow-hidden max-w-md mx-auto bg-background-light dark:bg-background-dark font-display",dir:"rtl"},L={class:"sticky top-0 z-20 bg-background-light/95 dark:bg-background-dark/95 backdrop-blur-md border-b border-slate-100 dark:border-slate-800/10 transition-all duration-200",style:{"padding-top":"env(safe-area-inset-top)"}},V={class:"flex items-center justify-between px-4 py-3"},O={class:"overflow-x-auto no-scrollbar border-b border-slate-100 dark:border-slate-800/10 bg-white dark:bg-surface-dark"},B={class:"flex min-w-max px-4 py-2 gap-2"},E=["onClick"],F={class:"flex-1 overflow-y-auto overflow-x-hidden no-scrollbar pb-24"},G={class:"flex flex-col gap-3 p-4"},A={key:0,class:"text-center py-12 text-slate-400"},J={key:1,class:"text-center py-12 text-slate-400"},K={class:"material-symbols-outlined text-5xl"},Q={class:"mt-2"},W=["onClick"],X={class:"flex items-start justify-between gap-3 mb-3"},Y={class:"flex items-center gap-3"},Z={class:"font-bold text-slate-900 dark:text-white text-sm"},$={class:"text-xs text-slate-400"},ee={class:"text-sm text-slate-700 dark:text-slate-300 leading-relaxed line-clamp-3"},te={key:0,class:"mt-3 flex items-center gap-2 bg-blue-50 dark:bg-blue-900/20 p-2 rounded-lg"},se={class:"text-xs font-medium text-blue-700 dark:text-blue-300"},le={key:1,class:"mt-3"},ae=["onClick"],oe={key:2,class:"mt-3"},re=["onClick"],ne=["disabled"],ie={key:0,class:"material-symbols-outlined animate-spin text-[18px]"},de={class:"fixed bottom-0 left-0 right-0 bg-white/95 dark:bg-surface-dark/95 backdrop-blur-md border-t border-slate-200 dark:border-slate-800 pb-safe z-40"},ce={class:"flex items-center justify-around h-16 max-w-md mx-auto"},ue={class:"space-y-4"},pe=["disabled"],me={key:0,class:"material-symbols-outlined animate-spin text-[18px]"},he={key:0,class:"space-y-4"},be={class:"flex items-center gap-3 pb-4 border-b border-slate-100 dark:border-slate-800"},xe={class:"font-bold text-slate-900 dark:text-white"},fe={key:0,class:"text-sm text-slate-500"},ge={class:"bg-slate-50 dark:bg-slate-800/50 p-4 rounded-xl"},we={class:"text-sm text-slate-700 dark:text-slate-300 leading-relaxed"},ye={key:0,class:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-xl"},ke={class:"flex items-center gap-3"},_e={class:"font-bold text-slate-900 dark:text-white text-sm"},ve={key:0,class:"text-xs text-slate-500"},qe={key:1,class:"space-y-3"},Re={class:"text-sm font-bold text-slate-900 dark:text-white"},Ce={class:"max-h-48 overflow-y-auto space-y-2"},Te={class:"text-xs font-bold text-slate-900 dark:text-white"},Me={class:"text-sm text-slate-600 dark:text-slate-300"},De={key:0,class:"flex gap-2"},Ue=["disabled"],Pe={key:0,class:"material-symbols-outlined animate-spin text-[16px]"},ze={key:1},He={key:2,class:"pt-2"};function Ne(a,t,R,c,s,n){const C=h("Head"),T=h("Toast"),M=h("PullToRefresh"),f=h("Link"),k=h("Modal");return r(),o(x,null,[u(C,{title:"Ù…Ø³Ø§Ø¹Ø¯Ø©"}),u(T),e("div",S,[e("header",L,[e("div",V,[t[10]||(t[10]=e("div",{class:"flex items-center gap-3"},[e("div",{class:"size-10 rounded-full bg-rose-100 dark:bg-rose-900/30 flex items-center justify-center text-rose-600 dark:text-rose-400"},[e("span",{class:"material-symbols-outlined"},"volunteer_activism")]),e("div",null,[e("span",{class:"text-lg font-bold text-slate-900 dark:text-white"},"Ù…Ø³Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¬ÙŠØ±Ø§Ù†")])],-1)),e("button",{onClick:t[0]||(t[0]=l=>s.showNewRequestModal=!0),class:"flex items-center gap-1 px-3 py-2 bg-primary text-white rounded-xl text-sm font-bold shadow-lg shadow-primary/20"},[...t[9]||(t[9]=[e("span",{class:"material-symbols-outlined text-[18px]"},"add",-1),e("span",null,"Ø·Ù„Ø¨ Ù…Ø³Ø§Ø¹Ø¯Ø©",-1)])])])]),e("div",O,[e("div",B,[(r(!0),o(x,null,w(s.tabs,l=>(r(),o("button",{key:l.id,onClick:g=>s.activeTab=l.id,class:y(["h-9 px-4 rounded-full text-sm font-semibold transition-colors whitespace-nowrap",s.activeTab===l.id?"bg-primary text-white":"bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-400"])},i(l.label),11,E))),128))])]),e("div",F,[u(M,{onRefresh:n.loadData},{default:m(()=>[e("div",G,[s.loading?(r(),o("div",A,[...t[11]||(t[11]=[e("span",{class:"material-symbols-outlined text-4xl animate-spin"},"progress_activity",-1)])])):s.requests.length===0?(r(),o("div",J,[e("span",K,i(n.emptyIcon),1),e("p",Q,i(n.emptyMessage),1)])):(r(!0),o(x,{key:2},w(s.requests,l=>(r(),o("div",{key:l.id,onClick:g=>n.openDetails(l),class:"bg-white dark:bg-surface-dark p-4 rounded-2xl shadow-sm border border-slate-100 dark:border-slate-700 cursor-pointer active:bg-slate-50 dark:active:bg-slate-800 transition-colors"},[e("div",X,[e("div",Y,[e("div",{class:"size-10 rounded-full bg-cover bg-center bg-slate-100",style:b(`background-image: url('${l.requester?.photo||"https://ui-avatars.com/api/?name="+(l.requester?.name||"U")}');`)},null,4),e("div",null,[e("p",Z,i(l.requester?.name),1),e("p",$,i(n.formatDate(l.created_at)),1)])]),e("span",{class:y(["px-2 py-1 rounded-full text-[10px] font-bold",{"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":l.status==="open","bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400":l.status==="picked","bg-slate-100 text-slate-500 dark:bg-slate-800 dark:text-slate-400":l.status==="cancelled"}])},i(l.status==="open"?"Ù…ÙØªÙˆØ­":l.status==="picked"?"ØªÙ… Ø§Ù„Ø§Ù„ØªÙ‚Ø§Ø·":"Ù…Ù„ØºÙŠ"),3)]),e("p",ee,i(l.description),1),l.helper&&(s.activeTab==="my"||s.activeTab==="helped")?(r(),o("div",te,[e("div",{class:"size-6 rounded-full bg-cover bg-center",style:b(`background-image: url('${l.helper?.photo||"https://ui-avatars.com/api/?name="+(l.helper?.name||"H")}');`)},null,4),e("span",se,i(s.activeTab==="my"?"ÙŠØ³Ø§Ø¹Ø¯Ùƒ: ":"ØªØ³Ø§Ø¹Ø¯: ")+i(s.activeTab==="my"?l.helper?.name:l.requester?.name),1)])):d("",!0),s.activeTab==="available"?(r(),o("div",le,[e("button",{onClick:_(g=>n.pickRequest(l),["stop"]),class:"w-full py-2 bg-primary text-white rounded-lg text-sm font-bold shadow-sm"}," Ø³Ø£Ø³Ø§Ø¹Ø¯ ğŸ™‹ ",8,ae)])):d("",!0),s.activeTab==="my"&&l.status==="open"?(r(),o("div",oe,[e("button",{onClick:_(g=>n.cancelRequest(l),["stop"]),class:"w-full py-2 bg-red-500 text-white rounded-lg text-sm font-bold"}," Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø·Ù„Ø¨ ",8,re)])):d("",!0)],8,W))),128)),s.nextPageUrl&&!s.loading?(r(),o("button",{key:3,onClick:t[1]||(t[1]=(...l)=>n.loadMore&&n.loadMore(...l)),disabled:s.loadingMore,class:"w-full py-3 text-sm font-bold text-primary bg-primary/10 rounded-xl flex items-center justify-center gap-2"},[s.loadingMore?(r(),o("span",ie,"progress_activity")):d("",!0),e("span",null,i(s.loadingMore?"Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...":"ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø²ÙŠØ¯"),1)],8,ne)):d("",!0)])]),_:1},8,["onRefresh"])]),e("nav",de,[e("div",ce,[u(f,{href:"/dashboard",class:"flex flex-col items-center justify-center flex-1 h-full gap-1 text-slate-400 dark:text-slate-500 hover:text-slate-600 dark:hover:text-slate-300 transition-colors"},{default:m(()=>[...t[12]||(t[12]=[e("span",{class:"material-symbols-outlined"},"home",-1),e("span",{class:"text-[10px] font-medium"},"Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©",-1)])]),_:1}),u(f,{href:"/help",class:"flex flex-col items-center justify-center flex-1 h-full gap-1 text-primary"},{default:m(()=>[...t[13]||(t[13]=[e("span",{class:"material-symbols-outlined fill-1"},"volunteer_activism",-1),e("span",{class:"text-[10px] font-bold"},"Ù…Ø³Ø§Ø¹Ø¯Ø©",-1)])]),_:1}),u(f,{href:"/settings",class:"flex flex-col items-center justify-center flex-1 h-full gap-1 text-slate-400 dark:text-slate-500 hover:text-slate-600 dark:hover:text-slate-300 transition-colors"},{default:m(()=>[...t[14]||(t[14]=[e("span",{class:"material-symbols-outlined"},"person",-1),e("span",{class:"text-[10px] font-medium"},"Ø§Ù„Ø­Ø³Ø§Ø¨",-1)])]),_:1})])]),u(k,{show:s.showNewRequestModal,title:"Ø·Ù„Ø¨ Ù…Ø³Ø§Ø¹Ø¯Ø©",onClose:t[4]||(t[4]=l=>s.showNewRequestModal=!1)},{default:m(()=>[e("div",ue,[e("div",null,[t[15]||(t[15]=e("label",{class:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2"},"ÙˆØµÙ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©",-1)),v(e("textarea",{"onUpdate:modelValue":t[2]||(t[2]=l=>s.newRequestDescription=l),class:"w-full rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800/50 p-4 text-base text-slate-900 dark:text-white placeholder-slate-400 focus:border-primary focus:outline-none focus:ring-1 focus:ring-primary resize-none transition-colors",placeholder:"Ù…Ø«Ø§Ù„: Ù…Ø­ØªØ§Ø¬ Ø­Ø¯ ÙŠØ³Ø§Ø¹Ø¯Ù†ÙŠ Ø£Ù†Ù‚Ù„ Ø£Ø«Ø§Ø« Ø«Ù‚ÙŠÙ„...",rows:"4"},null,512),[[q,s.newRequestDescription]])]),e("button",{onClick:t[3]||(t[3]=(...l)=>n.submitNewRequest&&n.submitNewRequest(...l)),disabled:s.submitting||!s.newRequestDescription.trim(),class:"w-full py-4 bg-primary text-white font-bold rounded-xl shadow-lg shadow-primary/25 flex items-center justify-center gap-2 disabled:opacity-50"},[s.submitting?(r(),o("span",me,"progress_activity")):d("",!0),t[16]||(t[16]=e("span",null,"Ù†Ø´Ø± Ø·Ù„Ø¨ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©",-1))],8,pe)])]),_:1},8,["show"]),u(k,{show:s.showDetailsModal,title:"ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨",onClose:t[8]||(t[8]=l=>s.showDetailsModal=!1)},{default:m(()=>[s.selectedRequest?(r(),o("div",he,[e("div",be,[e("div",{class:"size-12 rounded-full bg-cover bg-center",style:b(`background-image: url('${s.selectedRequest.requester?.photo||"https://ui-avatars.com/api/?name="+(s.selectedRequest.requester?.name||"U")}');`)},null,4),e("div",null,[e("p",xe,i(s.selectedRequest.requester?.name),1),n.canSeePhone?(r(),o("p",fe,i(s.selectedRequest.requester?.phone),1)):d("",!0)])]),e("div",ge,[e("p",we,i(s.selectedRequest.description),1)]),s.selectedRequest.helper?(r(),o("div",ye,[t[17]||(t[17]=e("p",{class:"text-xs font-bold text-blue-600 dark:text-blue-400 mb-2"},"Ø§Ù„Ù…ØªØ·ÙˆØ¹ Ù„Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©",-1)),e("div",ke,[e("div",{class:"size-10 rounded-full bg-cover bg-center",style:b(`background-image: url('${s.selectedRequest.helper?.photo||"https://ui-avatars.com/api/?name="+(s.selectedRequest.helper?.name||"H")}');`)},null,4),e("div",null,[e("p",_e,i(s.selectedRequest.helper?.name),1),n.canSeeHelperPhone?(r(),o("p",ve,i(s.selectedRequest.helper?.phone),1)):d("",!0)])])])):d("",!0),s.selectedRequest.status==="picked"&&n.canComment?(r(),o("div",qe,[e("p",Re,"Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª ("+i(s.selectedRequest.comments?.length||0)+"/50)",1),e("div",Ce,[(r(!0),o(x,null,w(s.selectedRequest.comments,l=>(r(),o("div",{key:l.id,class:y(["flex gap-2 p-2 rounded-lg",l.user_id===n.currentUserId?"bg-primary/10":"bg-slate-50 dark:bg-slate-800"])},[e("div",{class:"size-8 rounded-full bg-cover bg-center shrink-0",style:b(`background-image: url('${l.user?.photo||"https://ui-avatars.com/api/?name="+(l.user?.name||"U")}');`)},null,4),e("div",null,[e("p",Te,i(l.user?.name),1),e("p",Me,i(l.comment),1)])],2))),128))]),(s.selectedRequest.comments?.length||0)<50?(r(),o("div",De,[v(e("input",{"onUpdate:modelValue":t[5]||(t[5]=l=>s.newComment=l),type:"text",class:"flex-1 rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800/50 px-4 py-2 text-sm focus:border-primary focus:outline-none focus:ring-1 focus:ring-primary",placeholder:"Ø§ÙƒØªØ¨ ØªØ¹Ù„ÙŠÙ‚Ø§Ù‹..."},null,512),[[q,s.newComment]]),e("button",{onClick:t[6]||(t[6]=(...l)=>n.addComment&&n.addComment(...l)),disabled:!s.newComment.trim()||s.addingComment,class:"px-4 py-2 bg-primary text-white rounded-xl text-sm font-bold disabled:opacity-50"},[s.addingComment?(r(),o("span",Pe,"progress_activity")):(r(),o("span",ze,"Ø¥Ø±Ø³Ø§Ù„"))],8,Ue)])):d("",!0)])):d("",!0),s.selectedRequest.status==="open"&&s.selectedRequest.requester_id!==n.currentUserId?(r(),o("div",He,[e("button",{onClick:t[7]||(t[7]=l=>n.pickRequest(s.selectedRequest)),class:"w-full py-3 bg-primary text-white font-bold rounded-xl"}," Ø³Ø£Ø³Ø§Ø¹Ø¯ ğŸ™‹ ")])):d("",!0)])):d("",!0)]),_:1},8,["show"])])],64)}const Oe=I(j,[["render",Ne]]);export{Oe as default};
